# **р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕Др╕зр╕гр╕Чр╕гр╕▓р╕Ър╕Бр╣Ир╕нр╕Щр╣Ар╕гр╕┤р╣Ир╕б**

## **Client р╕Др╕╖р╕нр╕нр╕░р╣Др╕г**

![[Client]]

## **Server р╕Др╕╖р╕нр╕нр╕░р╣Др╕г**

![[Server]]

## **HTTP**

![[1_hUWVb9Ecll30810Ni1Oq8Q.webp]]

- HTTP Request р╕Др╕╖р╕н р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Др╕│р╕Вр╕нр╕Ир╕▓р╕Бр╕Эр╕▒р╣Ир╕З _[[Client]]_ р╣Др╕Ыр╕вр╕▒р╕Зр╕Эр╕▒р╣Ир╕З _[[Server]]_ р╣Ар╕Юр╕╖р╣Ир╕нр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ър╕▓р╕Зр╕нр╕вр╣Ир╕▓р╕З ^2d82a9
- HTTP Response р╕Др╕╖р╕н р╕Бр╕▓р╕гр╕Чр╕╡р╣И _Server_ р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣И _Client р╕гр╣Йр╕нр╕Зр╕Вр╕нр╕Бр╕ер╕▒р╕Ър╕бр╕▓_ ^7b3493
- HTTP р╕Др╕╖р╕н Protocol р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕гр╕░р╕лр╕зр╣Ир╕▓р╕З Client р╣Бр╕ер╕░ Server

ЁЯФ╢ **ЁЯТбр╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╣Гр╕лр╣Йр╣Ар╕лр╣Зр╕Щр╕ар╕▓р╕Ю**
р╕ер╕нр╕Зр╕Ир╕┤р╕Щр╕Хр╕Щр╕▓р╕Бр╕▓р╕гр╕зр╣Ир╕▓ **р╕Ър╣Йр╕▓р╕Щр╕Вр╕нр╕З Frontend** (р╕Эр╕▒р╣Ир╕З Client) р╕Др╕╖р╕нр╕Ьр╕╣р╣Йр╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕в р╣Бр╕ер╕░ **р╕Ър╣Йр╕▓р╕Щр╕Вр╕нр╕З Backend** (р╕Эр╕▒р╣Ир╕З Server) р╕Др╕╖р╕нр╕Ър╣Йр╕▓р╕Щр╕Вр╕нр╕Зр╣Ар╕Юр╕╖р╣Ир╕нр╕Щр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕нр╕вр╕▓р╕Бр╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ър╕▓р╕Зр╕нр╕вр╣Ир╕▓р╕З р╣Ар╕Кр╣Ир╕Щ р╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓ р╕лр╕гр╕╖р╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

- **HTTP Request** р╕Бр╣Зр╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Ъ **р╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕Ир╕▓р╕Бр╕Ър╣Йр╕▓р╕Щ Frontend р╣Др╕Ыр╕Ър╣Йр╕▓р╕Щ Backend** р╣Ар╕Юр╕╖р╣Ир╕нр╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕е
- **HTTP Response** р╕Бр╣Зр╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Ъ **р╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Ир╕▓р╕Бр╕Ър╣Йр╕▓р╕Щ Backend р╕бр╕▓р╕вр╕▒р╕Зр╕Ър╣Йр╕▓р╕Щ Frontend** р╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Вр╕нр╣Др╕зр╣Й р╣Ар╕Кр╣Ир╕Щ р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕кр╕┤р╕Щр╕Др╣Йр╕▓, р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Вр╕нр╕Зр╕Бр╕▓р╕гр╕кр╕бр╕▒р╕Др╕гр╕кр╕бр╕▓р╕Кр╕┤р╕Б, р╕лр╕гр╕╖р╕нр╕Ьр╕ер╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ
- р╕кр╣Ир╕зр╕Щ **HTTP Protocol** р╕Бр╣Зр╕Др╕╖р╕н **р╕гр╕░р╕Ър╕Ър╣Др╕Ыр╕гр╕йр╕Ур╕╡р╕вр╣Мр╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щ** р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Ър╣Йр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕кр╕нр╕Зр╕лр╕ер╕▒р╕Зр╣Гр╕лр╣Йр╕кр╕╖р╣Ир╕нр╕кр╕▓р╕гр╕Бр╕▒р╕Щр╣Др╕Фр╣Йр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╣Бр╕ер╕░р╕бр╕╡р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Чр╕╡р╣Ир╣Бр╕Щр╣Ир╕Щр╕нр╕Щ

### **Component of HTTP Request Message**

р╕Бр╕▓р╕гр╕Чр╕╡р╣И [[Client]] р╕кр╣Ир╕Зр╕Др╕│р╕гр╣Йр╕нр╕Зр╣Др╕Ыр╕лр╕▓ Server р╕Щр╕▒р╣Йр╕Щр╕Ир╕░р╕бр╕╡р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Вр╕нр╕Зр╕Бр╕▓р╕гр╕кр╣Ир╕З р╣Ар╕гр╕╡р╕вр╕Бр╕зр╣Ир╕▓ [[Start Point#^2d82a9|_HTTP Request Message_]] р╕Др╕╖р╕нр╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╕Ър╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Гр╕лр╣Йр╕Бр╕▒р╕Ър╕нр╕╡р╕Бр╕Эр╕▒р╣Ир╕Зр╕Чр╕гр╕▓р╕Ъ (р╣Гр╕Щр╕Чр╕╡р╣Ир╕Щр╕╡р╣Йр╕Др╕╖р╕н [[Server]]) р╕Лр╕╢р╣Ир╕З [[Start Point#^7b3493|HTTP Response]] р╕Бр╣Зр╕бр╕╡р╕ер╕▒р╕Бр╕йр╕Ур╕░р╣Ар╕Кр╣Ир╕Щр╣Ар╕Фр╕╡р╕вр╕зр╕Бр╕▒р╕Щ

ЁЯФ╢ **ЁЯТМ р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╕Ир╕Фр╕лр╕бр╕▓р╕в**
р╕ер╕нр╕Зр╕Щр╕╢р╕Бр╕ар╕▓р╕Юр╕зр╣Ир╕▓ HTTP Request р╕Др╕╖р╕нр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╣Ир╕Зр╕нр╕нр╕Бр╣Др╕Ы р╕бр╕▒р╕Щр╕Ир╕░р╕Хр╣Йр╕нр╕Зр╕бр╕╡р╕кр╣Ир╕зр╕Щр╕Ыр╕гр╕░р╕Бр╕нр╕Ър╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щр╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Ир╕гр╕┤р╕Зр╣Ж р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕Ыр╕ер╕▓р╕вр╕Чр╕▓р╕Зр╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕зр╣Ир╕▓р╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕нр╕░р╣Др╕г р╣Ар╕Кр╣Ир╕Щ

### **HTTP Request Message р╕Ыр╕гр╕░р╕Бр╕нр╕Ър╕Фр╣Йр╕зр╕в 3 р╕кр╣Ир╕зр╕Щ**

![[1_FOH7gWJH5CA20pCaKoABvg.gif]]

#### **1. Request Line**
р╕Др╕╖р╕нр╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╕гр╕░р╕Ър╕╕ HTTP Method, URI р╣Бр╕ер╕░ Version р╕Вр╕нр╕З Protocol р╕Чр╕╡р╣Ир╣Гр╕Кр╣Й (HTTP/1.0, HTTP/1.1, HTTP/2.0)
- HTTP Method р╕Др╕╖р╕н р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╕Чр╕╡р╣И Client р╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕гр╣Йр╕нр╕Зр╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Server р╣Ар╕Кр╣Ир╕Щ GET, POST, PUT, DELETE
- URI (Uniform Resource Identifier) р╕Др╕╖р╕н р╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╕Вр╕нр╕З Resource р╕Чр╕╡р╣И Client р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕гр╣Йр╕нр╕Зр╕Вр╕н р╣Ар╕Кр╣Ир╕Щ /api/user, /api/product
- Version р╕Др╕╖р╕н р╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╕Вр╕нр╕З Protocol р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н р╣Ар╕Кр╣Ир╕Щ HTTP/1.1, HTTP/2.0

ЁЯФ╢ **тЬЙя╕П р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╕лр╕Щр╣Йр╕▓р╕Лр╕нр╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕в**
- HTTP Method р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▓р╕гр╕гр╕░р╕Ър╕╕р╕зр╣Ир╕▓р╣Ар╕гр╕▓р╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╣Ар╕Юр╕╖р╣Ир╕н **р╕Вр╕нр╕Вр╕нр╕З (GET)**, **р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣И (POST)**, р╕лр╕гр╕╖р╕н **р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Вр╕нр╕Зр╣Ар╕Фр╕┤р╕б (PUT)**
- URI р╕Др╕╖р╕н **р╕Кр╕╖р╣Ир╕нр╣Бр╕ер╕░р╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╕Вр╕нр╕Зр╣Ар╕Юр╕╖р╣Ир╕нр╕Щр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Ир╕░р╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Цр╕╢р╕З**
- Version р╕Бр╣Зр╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Ъ **р╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╕╡р╕вр╕Щр╕Ир╕Фр╕лр╕бр╕▓р╕в** р╕Чр╕╡р╣Ир╕Чр╕▒р╣Йр╕Зр╕кр╕нр╕Зр╕Эр╣Ир╕▓р╕вр╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕гр╣Ир╕зр╕бр╕Бр╕▒р╕Щ р╣Ар╕Кр╣Ир╕Щ р╕Ир╕░р╣Ар╕Вр╕╡р╕вр╕Щр╕Фр╣Йр╕зр╕вр╕ар╕▓р╕йр╕▓р╕Чр╕▓р╕Зр╕Бр╕▓р╕гр╕лр╕гр╕╖р╕нр╣Др╕бр╣И

#### **2. Header**
р╕Др╕╖р╕нр╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╕гр╕░р╕Ър╕╕р╕Вр╣Йр╕нр╕бр╕╣р╕е р╣Бр╕ер╕░р╕Бр╕Пр╕Хр╣Ир╕▓р╕Зр╣Ж р╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н р╣Ар╕Кр╣Ир╕Щ
- **Content-type** р╕Др╕╖р╕нр╕гр╕░р╕Ър╕╕р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕Вр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щ Body р╕Чр╕╡р╣Ир╕Ир╕░р╕кр╣Ир╕Зр╣Др╕Ыр╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Ъ Request р╣Ар╕Кр╣Ир╕Щ application/json, text/html
- **accept-language** р╕Др╕╖р╕нр╕гр╕░р╕Ър╕╕р╕ар╕▓р╕йр╕▓р╕Чр╕╡р╣И Client р╕гр╕нр╕Зр╕гр╕▒р╕Ъ р╣Ар╕Кр╣Ир╕Щ en-US, th-TH
- **user-agent** р╕Др╕╖р╕нр╕гр╕░р╕Ър╕╕р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕Вр╕нр╕З Client р╣Ар╕Кр╣Ир╕Щ Mozilla/5.0 (р╕лр╕гр╕╖р╕нр╕Бр╣Зр╕Др╕╖р╕н Request р╕Щр╕╡р╣Йр╕Цр╕╣р╕Бр╕кр╣Ир╕Зр╕бр╕▓р╕Ир╕▓р╕Б Browser Mozilla Firefox р╕Щр╕▒р╣Ир╕Щр╣Ар╕нр╕З)

ЁЯФ╢ **ЁЯУж р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Бр╕Щр╕Ър╣Гр╕Щр╕Ир╕Фр╕лр╕бр╕▓р╕в**
Header р╕Бр╣Зр╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Ъ **р╕Бр╕гр╕░р╕Фр╕▓р╕йр╣Вр╕Щр╣Йр╕Хр╕лр╕гр╕╖р╕нр╕кр╕▒р╕Нр╕ер╕▒р╕Бр╕йр╕Ур╣Мр╣Бр╕Щр╕Ър╣Гр╕Щр╕Ир╕Фр╕лр╕бр╕▓р╕в** р╕Чр╕╡р╣Ир╕Ър╕нр╕Бр╕зр╣Ир╕▓
- "р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Бр╕Щр╕Ър╕бр╕▓р╕Щр╕╡р╣Йр╣Ар╕Ыр╣Зр╕Щр╣Ар╕нр╕Бр╕кр╕▓р╕г PDF р╕Щр╕░" (`Content-Type`)
- "р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╣Ар╕Ыр╣Зр╕Щр╕ар╕▓р╕йр╕▓р╣Др╕Чр╕вр╕лр╕гр╕╖р╕нр╕нр╕▒р╕Зр╕Бр╕др╕й" (`accept-language`)
- "р╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Щр╕╡р╣Йр╕кр╣Ир╕Зр╕бр╕▓р╕Ир╕▓р╕Бр╕бр╕╖р╕нр╕Цр╕╖р╕нр╕лр╕гр╕╖р╕нр╕Др╕нр╕бр╕Юр╕┤р╕зр╣Ар╕Хр╕нр╕гр╣М" (`user-agent`)

#### **3. Body**
р╕Др╕╖р╕нр╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╣Ар╕Бр╣Зр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╣Др╕Ыр╕вр╕▒р╕З Server р╣Ар╕Кр╣Ир╕Щ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕г Login, р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕г Register, р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕г Update Profile р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕Щ
- Body р╕Ир╕░р╕бр╕╡р╣Ар╕Йр╕Юр╕▓р╕░р╣Гр╕Щр╕Ър╕▓р╕З HTTP Method р╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ р╣Ар╕Кр╣Ир╕Щ POST, PUT, PATCH

ЁЯФ╢ **ЁЯУД р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╕Вр╕нр╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕в**
Body р╕Бр╣Зр╕Др╕╖р╕н **р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕нр╕вр╕▓р╕Бр╕Юр╕╣р╕Фр╕лр╕гр╕╖р╕нр╕гр╣Йр╕нр╕Зр╕Вр╕нр╣Гр╕Щр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Щр╕▒р╣Йр╕Щр╕Ир╕гр╕┤р╕Зр╣Ж** р╣Ар╕Кр╣Ир╕Щ
- "р╕кр╕зр╕▒р╕кр╕Фр╕╡р╕Др╕гр╕▒р╕Ъ р╕Ьр╕бр╕Кр╕╖р╣Ир╕н... р╕Ьр╕бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ"
- "р╕Щр╕╡р╣Ир╕Др╕╖р╕нр╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Бр╕▓р╕гр╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╕Вр╕нр╕Зр╕Ьр╕б р╕Бр╕гр╕╕р╕Ур╕▓р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕ер╕▒р╕Ър╕Фр╣Йр╕зр╕в"

### **HTTP Method**
HTTP Request Method р╕Др╕╖р╕нр╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Бр╕│р╕лр╕Щр╕Фр╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕Вр╕нр╕Зр╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕н р╣Вр╕Фр╕вр╕Ир╕░р╕бр╕╡р╕нр╕вр╕╣р╣И 4 Methods р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ър╣Ир╕нр╕в р╕бр╕╡р╕Фр╕▒р╕Зр╕Щр╕╡р╣Й
- `GET` : р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Вр╕н request р╕Ир╕▓р╕Б server р╣Ар╕Кр╣Ир╕Щ р╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф р╕лр╕гр╕╖р╕нр╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╣Ар╕Фр╕╡р╣Ир╕вр╕з
- `PUT` : р╕кр╕│р╕лр╕гр╕▒р╕Ъ update р╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕бр╕╡р╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕з р╣Бр╕ер╕░р╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Ир╕░р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Ир╕░р╕нр╕вр╕╣р╣Ир╣Гр╕Щ Body
- `POST` : р╕кр╕│р╕лр╕гр╕▒р╕Ъ create р╕лр╕гр╕╖р╕нр╣Ар╕Юр╕┤р╣Ир╕бр╕Др╣Ир╕▓р╣Гр╕лр╕бр╣И р╣Бр╕ер╕░р╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Ир╕░р╣Ар╕Юр╕┤р╣Ир╕бр╕Ир╕░р╕нр╕вр╕╣р╣Ир╣Гр╕Щ Body
- `DELETE` : р╕кр╕│р╕лр╕гр╕▒р╕Ър╕ер╕Ър╕Др╣Ир╕▓

ЁЯФ╢ **ЁЯТМ р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕Цр╕╢р╕Зр╕Ър╣Йр╕▓р╕Щ Backend**
р╕ер╕нр╕Зр╕Ир╕┤р╕Щр╕Хр╕Щр╕▓р╕Бр╕▓р╕гр╕зр╣Ир╕▓ HTTP Method р╕Др╕╖р╕н **р╣Ар╕Ир╕Хр╕Щр╕▓р╕лр╕ер╕▒р╕Бр╕Вр╕нр╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╣Ир╕Зр╣Др╕Ы** р╕зр╣Ир╕▓р╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Гр╕лр╣Йр╕Ър╣Йр╕▓р╕Щ Backend р╕Чр╕│р╕нр╕░р╣Др╕гр╣Гр╕лр╣Йр╕Ър╣Йр╕▓р╕З:

- тЬЙя╕П `GET` ЁЯСЙ р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╣Др╕Ыр╕Цр╕▓р╕бр╕зр╣Ир╕▓
  > "р╕Вр╕нр╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕лр╕Щр╣Ир╕нр╕вр╕Др╕гр╕▒р╕Ъ" р╕лр╕гр╕╖р╕н
  > "р╕Вр╕нр╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Вр╕нр╕Зр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Кр╕┤р╣Йр╕Щр╕Щр╕╡р╣Йр╕лр╕Щр╣Ир╕нр╕вр╕Др╕гр╕▒р╕Ъ"
  тЬЕ р╣Др╕бр╣Ир╣Бр╕Щр╕Ър╕нр╕░р╣Др╕гр╣Др╕Ыр╣Ар╕ер╕в р╣Бр╕Др╣Ир╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕ер╕▒р╕Ър╕бр╕▓

- тЬЙя╕П `POST` ЁЯСЙ р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Юр╕гр╣Йр╕нр╕бр╣Бр╕Щр╕Ър╣Бр╕Ър╕Ър╕Яр╕нр╕гр╣Мр╕бр╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ
  > "р╕Щр╕╡р╣Ир╕Др╕╖р╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Вр╕нр╕Зр╕кр╕бр╕▓р╕Кр╕┤р╕Бр╣Гр╕лр╕бр╣И р╕Бр╕гр╕╕р╕Ур╕▓р╕кр╕гр╣Йр╕▓р╕Зр╣Гр╕лр╣Йр╕Фр╣Йр╕зр╕вр╕Др╕гр╕▒р╕Ъ"
  тЬЕ р╣Бр╕Щр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣Ир╣Др╕Ыр╣Гр╕Щ Body р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Й Backend р╕кр╕гр╣Йр╕▓р╕Зр╕кр╕┤р╣Ир╕Зр╣Гр╕лр╕бр╣И

- тЬЙя╕П `PUT` ЁЯСЙ р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Юр╕гр╣Йр╕нр╕бр╣Др╕Яр╕ер╣Мр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕▒р╕Ыр╣Ар╕Фр╕Х
  > "р╕Щр╕╡р╣Ир╕Др╕╖р╕нр╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Чр╕╡р╣Ир╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Вр╕нр╕Зр╕кр╕бр╕▓р╕Кр╕┤р╕Бр╕Др╕Щр╕Щр╕╡р╣Й р╕гр╕Ър╕Бр╕зр╕Щр╣Бр╕Бр╣Йр╣Др╕Вр╣Гр╕лр╣Йр╕Фр╣Йр╕зр╕вр╕Др╕гр╕▒р╕Ъ"
  тЬЕ р╣Бр╕Щр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Фр╕┤р╕бр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Бр╕Бр╣Й р╕Юр╕гр╣Йр╕нр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣Ир╣Др╕Ыр╣Гр╕Щ Body

- тЬЙя╕П `DELETE` ЁЯСЙ р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╣Др╕Ыр╣Бр╕Ир╣Йр╕Зр╕вр╕Бр╣Ар╕ер╕┤р╕Б
  > "р╕гр╕Ър╕Бр╕зр╕Щр╕ер╕Ър╕кр╕бр╕▓р╕Кр╕┤р╕Бр╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Щр╕╡р╣Йр╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕гр╕░р╕Ър╕Ър╕Фр╣Йр╕зр╕вр╕Др╕гр╕▒р╕Ъ"
  тЬЕ р╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕нр╕Зр╣Бр╕Щр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕бр╕▓р╕Б р╣Бр╕Др╣Ир╕гр╕░р╕Ър╕╕р╕зр╣Ир╕▓ тАЬр╕Ир╕░р╕ер╕Ър╕нр╕░р╣Др╕гтАЭ

ЁЯОп р╕кр╕гр╕╕р╕Ы: HTTP Method р╕Др╕╖р╕н **р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕лр╕ер╕▒р╕Бр╕Вр╕нр╕Зр╕Бр╕▓р╕гр╕кр╕╖р╣Ир╕нр╕кр╕▓р╕гр╣Гр╕Щр╣Бр╕Хр╣Ир╕ер╕░р╕Ир╕Фр╕лр╕бр╕▓р╕в** р╕зр╣Ир╕▓р╣Ар╕гр╕▓р╕Ир╕░ "р╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕е", "р╣Ар╕Юр╕┤р╣Ир╕б", "р╕нр╕▒р╕Ыр╣Ар╕Фр╕Х" р╕лр╕гр╕╖р╕н "р╕ер╕Ъ" р╕кр╕┤р╣Ир╕Зр╣Гр╕Фр╕Ир╕▓р╕Бр╕Ър╣Йр╕▓р╕Щ Backend

### **HTTP Status Code**

^16cb86

р╣Ар╕бр╕╖р╣Ир╕н _[[Server]]_ р╣Др╕Фр╣Йр╕гр╕▒р╕Ъ _[[Start Point#^2d82a9|HTTP Request]]_ р╣Бр╕ер╣Йр╕з р╕Ир╕░р╕Чр╕│р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕н р╣Бр╕ер╕░р╕кр╣Ир╕Зр╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕вр╕▒р╕З _[[Client]]_ р╣Вр╕Фр╕вр╕Ир╕░р╕бр╕╡р╕Бр╕▓р╕гр╕кр╣Ир╕З _[[Start Point#^7b3493|HTTP Response]]_ р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕Фр╣Йр╕зр╕в р╕Лр╕╢р╣Ир╕Зр╣Гр╕Щ _[[Start Point#^7b3493|HTTP Response]]_ р╕Ир╕░р╕бр╕╡р╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╣Ар╕гр╕╡р╕вр╕Бр╕зр╣Ир╕▓ _[[Start Point#^16cb86|Status Code]]_ р╣Ар╕Юр╕╖р╣Ир╕нр╕Ър╕нр╕Бр╕кр╕Цр╕▓р╕Щр╕░р╕Вр╕нр╕Зр╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕нр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╣Др╕Ыр╕зр╣Ир╕▓р╣Ар╕Ыр╣Зр╕Щр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г р╣Ар╕Кр╣Ир╕Щ
- 200 OK : р╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕нр╕кр╕│р╣Ар╕гр╣Зр╕И
- 201 Created : р╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕нр╕кр╕│р╣Ар╕гр╣Зр╕И р╣Бр╕ер╕░р╕бр╕╡р╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З Resource р╣Гр╕лр╕бр╣И
- 204 No Content : р╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕нр╕кр╕│р╣Ар╕гр╣Зр╕И р╣Бр╕Хр╣Ир╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╣Ир╕Зр╕Бр╕ер╕▒р╕Ъ
- 400 Bad Request : р╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕нр╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
- 401 Unauthorized : р╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕нр╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З р╕Хр╣Йр╕нр╕Зр╕бр╕╡р╕Бр╕▓р╕гр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щ
- 403 Forbidden : р╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕нр╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З р╣Др╕бр╣Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕З Resource
- 404 Not Found : р╣Др╕бр╣Ир╕Юр╕Ъ Resource р╕Чр╕╡р╣Ир╕гр╣Йр╕нр╕Зр╕Вр╕н
- 500 Internal Server Error : р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╕ар╕▓р╕вр╣Гр╕Щ Server
- 502 Bad Gateway : Server р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Бр╕▒р╕Ъ Server р╕нр╕╖р╣Ир╕Щр╣Др╕Фр╣Й

ЁЯФ╢ **ЁЯУм р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Ир╕▓р╕Бр╕Ър╣Йр╕▓р╕Щ Backend**
р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕гр╕▓р╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕в (HTTP Request) р╣Др╕Ыр╕Чр╕╡р╣Ир╕Ър╣Йр╕▓р╕Щ Backend р╕Эр╕▒р╣Ир╕Зр╕Хр╕гр╕Зр╕Вр╣Йр╕▓р╕б р╕Бр╣Зр╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Ар╕гр╕▓р╕гр╕нр╕гр╕▒р╕Ър╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Бр╕ер╕▒р╕Ър╕бр╕▓ р╕Лр╕╢р╣Ир╕Зр╣Гр╕Щр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Щр╕▒р╣Йр╕Щр╕Ир╕░р╕бр╕╡ **"р╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ"** р╕зр╣Ир╕▓р╣Ар╕Бр╕┤р╕Фр╕нр╕░р╣Др╕гр╕Вр╕╢р╣Йр╕Щ р╣Ар╕Кр╣Ир╕Щ:

- тЬЕ `200 OK` ЁЯСЙ "р╕Вр╕нр╕Чр╕╡р╣Ир╕Др╕╕р╕Ур╕гр╣Йр╕нр╕Зр╕Вр╕нр╣Др╕Фр╣Йр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕вр╣Бр╕ер╣Йр╕з!"
  > р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Ър╣Йр╕▓р╕Щ Backend р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕бр╕▓р╕зр╣Ир╕▓ "р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕Др╕│р╕Вр╕нр╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Гр╕лр╣Йр╣Ар╕кр╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕зр╕Др╕гр╕▒р╕Ъ"

- тЬЕ `201 Created` ЁЯСЙ "р╣Ар╕гр╕▓р╣Др╕Фр╣Йр╕кр╕гр╣Йр╕▓р╕Зр╕кр╕┤р╣Ир╕Зр╣Гр╕лр╕бр╣Ир╣Гр╕лр╣Йр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕вр╣Бр╕ер╣Йр╕з!"
  > р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Ър╕нр╕Бр╕зр╣Ир╕▓ "р╕кр╕бр╕▒р╕Др╕гр╕кр╕бр╕▓р╕Кр╕┤р╕Бр╣Гр╕лр╣Йр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕вр╣Бр╕ер╣Йр╕зр╕Щр╕░р╕Др╕гр╕▒р╕Ъ"

- тЬЕ `204 No Content` ЁЯСЙ "р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в р╣Бр╕Хр╣Ир╣Др╕бр╣Ир╕бр╕╡р╕нр╕░р╣Др╕гр╕Ир╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ"
  > р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Ър╣Йр╕▓р╕Щ Backend р╕Ър╕нр╕Бр╕зр╣Ир╕▓ "р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Гр╕лр╣Йр╣Бр╕ер╣Йр╕з р╣Бр╕Хр╣Ир╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╣Йр╕нр╕Зр╕кр╣Ир╕Зр╕Бр╕ер╕▒р╕Ъ"

- тЭМ `400 Bad Request` ЁЯСЙ "р╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Др╕╕р╕Ур╕кр╣Ир╕Зр╕бр╕▓р╕Ьр╕┤р╕Фр╕Яр╕нр╕гр╣Мр╕б р╕нр╣Ир╕▓р╕Щр╣Др╕бр╣Ир╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╣Ар╕ер╕в!"
  > р╣Ар╕Кр╣Ир╕Щ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╕Вр╕▓р╕Фр╕Ър╕▓р╕Зр╕Кр╣Ир╕нр╕З р╕лр╕гр╕╖р╕нр╣Гр╕Кр╣Йр╕Яр╕нр╕гр╣Мр╕бр╕Ьр╕┤р╕Ф

- тЭМ `401 Unauthorized` ЁЯСЙ "р╕Др╕╕р╕Ур╕вр╕▒р╕Зр╣Др╕бр╣Ир╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щ р╕лр╣Йр╕▓р╕бр╣Ар╕Вр╣Йр╕▓!"
  > р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╣Др╕бр╣Ир╣Бр╕Щр╕Ър╕лр╕ер╕▒р╕Бр╕Рр╕▓р╕Щр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щ р╣Ар╕Кр╣Ир╕Щ token

- тЭМ `403 Forbidden` ЁЯСЙ "р╕Цр╕╢р╕Зр╕Др╕╕р╕Ур╕Ир╕░р╕ер╣Зр╕нр╕Бр╕нр╕┤р╕Щр╣Бр╕ер╣Йр╕з р╣Бр╕Хр╣Ир╕Бр╣Зр╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Щр╕╡р╣Й"
  > р╣Ар╕Кр╣Ир╕Щ р╕Юр╕Щр╕▒р╕Бр╕Зр╕▓р╕Щр╕Чр╕▒р╣Ир╕зр╣Др╕Ыр╕Ир╕░р╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕▒р╕Ър╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╕Ър╕гр╕┤р╕лр╕▓р╕гр╣Др╕бр╣Ир╣Др╕Фр╣Й

- тЭМ `404 Not Found` ЁЯСЙ "р╕Ър╣Йр╕▓р╕Щр╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╕лр╕гр╕╖р╕нр╕Чр╕гр╕▒р╕Юр╕вр╕▓р╕Бр╕гр╕Чр╕╡р╣Ир╕Др╕╕р╕Ур╕Вр╕нр╕бр╕▓... р╣Др╕бр╣Ир╕бр╕╡р╕нр╕вр╕╣р╣Ир╕Ир╕гр╕┤р╕З!"
  > р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Юр╕вр╕▓р╕вр╕▓р╕бр╣Ар╕Вр╣Йр╕▓р╕лр╕Щр╣Йр╕▓ `/product/999` р╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕бр╕╡р╣Гр╕Щр╕гр╕░р╕Ър╕Ъ

- тЭМ `500 Internal Server Error` ЁЯСЙ "р╕гр╕░р╕Ър╕Ър╕ар╕▓р╕вр╣Гр╕Щр╕Ър╣Йр╕▓р╕Щ Backend р╕ер╣Ир╕б!"
  > р╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕Ър╣Йр╕▓р╕Щр╕Чр╕│р╕Зр╕▓р╕Щр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╣Ар╕нр╕Зр╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕лр╕ер╕▒р╕Зр╕Ър╣Йр╕▓р╕Щ

- тЭМ `502 Bad Gateway` ЁЯСЙ "р╕Ър╣Йр╕▓р╕Щ Backend р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Ър╣Йр╕▓р╕Щр╕лр╕ер╕▒р╕Зр╕нр╕╖р╣Ир╕Щр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╣Ар╕ер╕в"
  > р╣Ар╕Кр╣Ир╕Щ р╕гр╕░р╕Ър╕Ър╕Юр╕вр╕▓р╕вр╕▓р╕бр╣Др╕Ыр╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б API р╕нр╕╖р╣Ир╕Щр╣Бр╕ер╣Йр╕зр╣Ар╕Ир╕нр╕Ыр╕▒р╕Нр╕лр╕▓

ЁЯОп р╕кр╕гр╕╕р╕Ы: HTTP Status Code р╕Др╕╖р╕н **р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕кр╕▒р╣Йр╕Щр╣Ж р╣Гр╕Щр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ** р╕Ир╕▓р╕Бр╕Ър╣Йр╕▓р╕Щ Backend р╣Ар╕Юр╕╖р╣Ир╕нр╕Ър╕нр╕Бр╣Ар╕гр╕▓р╕зр╣Ир╕▓р╕Ьр╕ер╕Вр╕нр╕Зр╕Др╕│р╕Вр╕нр╣Ар╕Ыр╣Зр╕Щр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г тАФ р╕кр╕│р╣Ар╕гр╣Зр╕И, р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з, р╕лр╕гр╕╖р╕нр╕гр╕░р╕Ър╕Ър╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓

# р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Вр╕нр╕Зр╕Бр╕▓р╕гр╕Чр╕│ Backend
## **1. р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М**
### **1.1 р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Гр╕Щр╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕Зр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г**
![[Pasted image 20250401034412.png]]
### **1.2 р╣Ар╕Ыр╕┤р╕Фр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕вр╣Ир╕нр╕вр╕Вр╣Йр╕▓р╕Зр╣Гр╕Щ**
р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М backend р╣Бр╕ер╕░ frontend
![[Pasted image 20250401034424.png]]
## **2. Setup Database**

SQL Database р╕Щр╕▒р╣Йр╕Щр╕Ир╕гр╕┤р╕Зр╣Ж р╣Бр╕ер╣Йр╕зр╕бр╕╡р╕лр╕ер╕▓р╕вр╕Хр╕▒р╕зр╕бр╕▓р╕Б р╣Ар╕Кр╣Ир╕Щ MySQL, PostgreSQL, SQLite р╣Бр╕Хр╣Ир╣Гр╕Щр╕Чр╕╡р╣Ир╕Щр╕╡р╣Йр╕Ир╕░р╣Гр╕Кр╣Й PostgreSQL р╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Ир╕▓р╕Бр╣Ар╕Ыр╣Зр╕Щ Database р╕Чр╕╡р╣Ир╕Щр╕┤р╕вр╕бр╣Гр╕Кр╣Йр╕Бр╕▒р╕Щр╕бр╕▓р╕Бр╣Гр╕Щр╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ р╣Бр╕ер╕░р╕бр╕╡р╕Др╕зр╕▓р╕бр╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Щр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Лр╕▒р╕Ър╕Лр╣Йр╕нр╕Щр╣Др╕Фр╣Йр╕Фр╕╡
р╣Бр╕ер╕░ р╕кр╕▓р╣Ар╕лр╕Хр╕╕р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╣Ар╕Ыр╕┤р╕Фр╣Гр╕Щ Docker р╣Ар╕Юр╕гр╕▓р╕░р╕зр╣Ир╕▓ Docker р╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Йр╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕г Database р╣Ар╕Ыр╣Зр╕Щр╣Др╕Ыр╕нр╕вр╣Ир╕▓р╕Зр╕Зр╣Ир╕▓р╕вр╕Фр╕▓р╕вр╣Бр╕ер╕░р╕гр╕зр╕Фр╣Ар╕гр╣Зр╕з р╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▒р╕Зр╕зр╕ер╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Бр╕ер╕░р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Др╕Яр╕ер╣Мр╕Хр╣Ир╕▓р╕Зр╣Ж р╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕Зр╕Бр╕▒р╕Ъ Database

р╕Хр╕▒р╕з Docker р╕Ир╕░р╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Йр╣Ар╕гр╕▓р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╕гр╣Йр╕▓р╕З Container р╕Чр╕╡р╣Ир╕бр╕╡ PostgreSQL р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╕нр╕вр╕╣р╣Ир╕ар╕▓р╕вр╣Гр╕Щр╣Др╕Фр╣Йр╕нр╕вр╣Ир╕▓р╕Зр╕гр╕зр╕Фр╣Ар╕гр╣Зр╕з р╣Бр╕ер╕░р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕ер╕Ър╕лр╕гр╕╖р╕нр╕гр╕╡р╕кр╕Хр╕▓р╕гр╣Мр╕Ч Container р╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕вр╣Ж р╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Бр╕гр╕░р╕Чр╕Ър╕Бр╕▒р╕Ър╕гр╕░р╕Ър╕Ър╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╕лр╕ер╕▒р╕Бр╕Вр╕нр╕Зр╣Ар╕гр╕▓

### **2.1 р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М Docker Compose**

р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М docker-compose.yml р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Гр╕лр╕Нр╣И

![[Pasted image 20250401034840.png]]

docker-compose.yml

```yml
version: '3.4'

services:

┬а postgres-db:

┬а ┬а image: postgres:17.4

┬а ┬а restart: always

┬а ┬а environment:

┬а ┬а ┬а POSTGRES_USER: admin

┬а ┬а ┬а POSTGRES_PASSWORD: password

┬а ┬а ┬а POSTGRES_DB: taskmanagement

┬а ┬а ports:

┬а ┬а ┬а - 5432:5432



┬а ┬а volumes:

┬а ┬а ┬а - type: bind

┬а ┬а ┬а ┬а source: ./database/init.sql

┬а ┬а ┬а ┬а target: /docker-entrypoint-initdb.d/init.sql
```

### **2.2 р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М init.sql**
р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М database р╣Бр╕ер╕░р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М init.sql р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕Щр╕▒р╣Йр╕Щ
![[Pasted image 20250401035227.png]]

р╣Гр╕Щр╣Др╕Яр╕ер╣М init.sql р╣Гр╕лр╣Йр╣Гр╕кр╣Ир╕Др╕│р╕кр╕▒р╣Ир╕З SQL (DDL) р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Гр╕лр╣Йр╕кр╕гр╣Йр╕▓р╕Зр╕Хр╕▓р╕гр╕▓р╕Зр╣Гр╕Щ Database

init.sql
```sql
CREATE TABLE users(
    user_id CHAR(5) PRIMARY KEY,
    username VARCHAR(100) NOT NULL,
    email VARCHAR(100) NOT NULL,
    password VARCHAR(255) NOT NULL,
    role VARCHAR(100) NOT NULL,
    CONSTRAINT uk_user_email UNIQUE (email)
);

CREATE TABLE project (
  project_id CHAR(5) PRIMARY KEY NOT NULL,
  project_name VARCHAR(100) NOT NULL,
  project_description TEXT,
  owner_id CHAR(5) NOT NULL,
  created_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  progress INT DEFAULT 0,
  category VARCHAR(100) NOT NULL,
  CONSTRAINT fk_owner FOREIGN KEY (owner_id) REFERENCES users(user_id) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE task(
  task_id CHAR(5) PRIMARY KEY NOT NULL,
  project_id CHAR(5) NOT NULL,
  task_name VARCHAR(100),
  task_description VARCHAR(280),
  start_date TIMESTAMP,
  due_date TIMESTAMP,
  status VARCHAR(20) DEFAULT 'pending',
  priority INT DEFAULT 0,
  created_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT fk_project FOREIGN KEY (project_id) REFERENCES project(project_id) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE attachment(
  attachment_id CHAR(5) PRIMARY KEY,
  attachment_name VARCHAR(100) NOT NULL,
  task_id CHAR(5) NOT NULL,
  file_url VARCHAR(1000),
  file_type VARCHAR(20) NOT NULL,
  created_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT fk_task FOREIGN KEY (task_id) REFERENCES task(task_id) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE project_member(
  project_id CHAR(5) NOT NULL,
  user_id CHAR(5) NOT NULL,
  CONSTRAINT fk_project FOREIGN KEY (project_id) REFERENCES project(project_id) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE ON UPDATE CASCADE,
  PRIMARY KEY (project_id, user_id)
);

CREATE TABLE task_assignee(
  task_id CHAR(5) NOT NULL,
  user_id CHAR(5) NOT NULL,
  PRIMARY KEY (task_id, user_id),
  CONSTRAINT fk_task FOREIGN KEY (task_id) REFERENCES task(task_id) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE ON UPDATE CASCADE
);

-- Add generate id function

CREATE OR REPLACE FUNCTION generate_user_id() RETURNS CHAR(5) AS $$
DECLARE
    max_id INT;
BEGIN
    SELECT COALESCE(MAX(user_id::int), 0) INTO max_id FROM users;
    RETURN LPAD((max_id + 1)::text, 5, '0');
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION generate_project_id() RETURNS CHAR(5) AS $$
DECLARE
    max_id INT;
BEGIN
    SELECT COALESCE(MAX(project_id::int), 0) INTO max_id FROM project;
    RETURN LPAD((max_id + 1)::text, 5, '0');
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION generate_task_id() RETURNS CHAR(5) AS $$
DECLARE
    max_id INT;
BEGIN
    SELECT COALESCE(MAX(task_id::int), 0) INTO max_id FROM task;
    RETURN LPAD((max_id + 1)::text, 5, '0');
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION generate_attachment_id() RETURNS CHAR(5) AS $$
DECLARE
    max_id INT;
BEGIN
    SELECT COALESCE(MAX(attachment_id::int), 0) INTO max_id FROM attachment;
    RETURN LPAD((max_id + 1)::text, 5, '0');
END;
$$ LANGUAGE plpgsql;

```

### **2.3 р╕зр╕┤р╕Шр╕╡ run database**

^4e71ae

#### 2.3.1 р╣Ар╕Ыр╕┤р╕Ф Docker Desktop р╕Вр╕╢р╣Йр╕Щр╕бр╕▓
![[20250331-2102-30.8108024.mp4]]

#### 2.3.2 р╕Цр╣Йр╕▓р╕бр╕╡ container р╣Гр╕лр╣Йр╕ер╕Ъ container р╕Чр╕╡р╣Ир╕бр╕╡р╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕з
![[20250331-2109-07.5062965.mp4]]

#### 2.3.3 р╣Ар╕Ыр╕┤р╕Ф terminal р╕Вр╕╢р╣Йр╕Щр╕бр╕▓р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Гр╕лр╕Нр╣Ир╕Чр╕╡р╣Ир╕бр╕╡р╣Др╕Яр╕ер╣М docker-compose.yml
р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Ыр╕┤р╕Ф powershell р╕Бр╣Зр╣Др╕Фр╣Й р╕лр╕гр╕╖р╕нр╕Ир╕░р╣Гр╕Кр╣Й terminal р╣Гр╕Щ VS Code р╕Бр╣Зр╣Др╕Фр╣Й р╣Гр╕Щр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Щр╕╡р╣Йр╕Ир╕░р╣Гр╕Кр╣Й terminal р╣Гр╕Щ VS Code
р╣Бр╕ер╕░р╕Юр╕┤р╕бр╕Юр╣Мр╕Др╕│р╕кр╕▒р╣Ир╕З

```bash
docker-compose up
```


![[20250331-2133-18.5619454.mp4]]

р╕Цр╣Йр╕▓р╣Ар╕гр╕▓р╣Ар╕лр╣Зр╕Щр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕зр╣Ир╕▓ "database system is ready to accept connections" р╣Бр╕кр╕Фр╕Зр╕зр╣Ир╕▓ database р╕Вр╕нр╕Зр╣Ар╕гр╕▓р╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Бр╕ер╣Йр╕з


#### 2.3.4 !!!р╕Цр╣Йр╕▓р╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕Зр╣Др╕Яр╕ер╣М init.sql!!!
р╕Цр╣Йр╕▓р╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕Зр╣Др╕Яр╕ер╣М init.sql р╣Бр╕ер╣Йр╕зр╕Хр╣Йр╕нр╕Зр╕гр╕╡р╕кр╕Хр╕▓р╕гр╣Мр╕Ч database р╕бр╕╡ 2 р╕зр╕┤р╕Шр╕╡

- **р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 1**: р╕ер╕Ъ container р╕Чр╕╡р╣Ир╕бр╕╡р╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕зр╣Гр╕Щ Docker Desktop р╣Бр╕ер╣Йр╕зр╕гр╕▒р╕Щ docker-compose up р╕Вр╕╢р╣Йр╕Щр╕бр╕▓р╣Гр╕лр╕бр╣И
![[20250331-2144-03.6506825.mp4]]

- **р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 2**: р╣Гр╕Кр╣Йр╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕Щ terminal

```bash
docker-compose down
docker-compose up
```

![[20250331-2145-23.2271100.mp4]]

## **3. р╕кр╕гр╣Йр╕▓р╕З npm project**
### **3.1 р╣Ар╕Ыр╕┤р╕Ф terminal р╕Вр╕╢р╣Йр╕Щр╕бр╕▓р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М backend**
р╣Бр╕ер╕░р╕Юр╕┤р╕бр╕Юр╣Мр╕Др╕│р╕кр╕▒р╣Ир╕З

```bash
npm init -y
```

![[20250331-2152-06.9653725.mp4]]

### **3.2 р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З express, nodemon**
р╕Юр╕┤р╕бр╕Юр╣Мр╕Др╕│р╕кр╕▒р╣Ир╕З

```bash
npm install express     р╕лр╕гр╕╖р╕н npm i express
```

```bash
npm install nodemon --save-dev     р╕лр╕гр╕╖р╕н npm i nodemon --save-dev
```

![[20250331-2159-48.3310727.mp4]]

### 3.3 р╣Ар╕ер╕╖р╕нр╕Бр╣Гр╕Кр╣Й nodemon р╣Гр╕Щр╕Бр╕▓р╕гр╕гр╕▒р╕Щр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д
![[20250331-2203-00.4222062.mp4]]

### 3.4 р╣Ар╕ер╕╖р╕нр╕Бр╣Гр╕Кр╣Йр╕зр╕┤р╕Шр╕╡р╣Гр╕Щр╕Бр╕▓р╕г import
р╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Ир╕▓р╕Б Javascript р╕бр╕╡ 2 р╕зр╕┤р╕Шр╕╡р╣Гр╕Щр╕Бр╕▓р╕г import р╕Др╕╖р╕н

- **CommonJS**: р╣Гр╕Кр╣Й `require`
``` javascript
const express = require('express');
```

- **ES Module**: р╣Гр╕Кр╣Й `import`
``` javascript
import express from 'express';
```

р╣Гр╕Щр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Щр╕╡р╣Йр╕Ир╕░р╣Гр╕Кр╣Й `Es Module` р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Гр╕лр╣Йр╣Др╕Ыр╕Чр╕╡р╣Ир╣Др╕Яр╕ер╣М package.json р╣Бр╕ер╣Йр╕зр╣Ар╕Юр╕┤р╣Ир╕б `"type": "module"` р╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╣Гр╕Щр╣Др╕Яр╕ер╣М package.json

![[20250331-2208-29.1184242.mp4]]

### р╣Др╕Яр╕ер╣М package.json
```json
{
  "name": "backend",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "type": "module",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "dev" : "nodemon index.js"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "express": "^5.1.0"
  },
  "devDependencies": {
    "nodemon": "^3.1.9"
  }
}

```
## **4. р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М index.js р╣Бр╕ер╕░ Express р╣Ар╕Ър╕╖р╣Йр╕нр╕Зр╕Хр╣Йр╕Щ**
### **4.1 р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М index.js**
р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М index.js р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М backend

```javascript
//index.js
import express from "express";

const app = express();
const PORT = 3000;

app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
});
```

**app.listen**
```javascript
app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
});
```

р╕Др╕╖р╕нр╕Бр╕▓р╕гр╕Ър╕нр╕Бр╣Гр╕лр╣Й _[[Server]]_ р╕гр╕нр╕гр╕▒р╕Ър╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕нр╕Ир╕▓р╕Б _[[Client]]_ р╕Чр╕╡р╣Ир╕Юр╕нр╕гр╣Мр╕Хр╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╣Ар╕Бр╣Зр╕Ър╣Др╕зр╣Йр╣Гр╕Щр╕Хр╕▒р╕зр╣Бр╕Ыр╕г PORT (р╣Гр╕Щр╕Чр╕╡р╣Ир╕Щр╕╡р╣Йр╕Др╕╖р╕н 3000) р╣Бр╕ер╕░р╣Ар╕бр╕╖р╣Ир╕н _[[Server]]_ р╣Ар╕гр╕┤р╣Ир╕бр╕Чр╕│р╕Зр╕▓р╕Щ р╕Ир╕░р╕бр╕╡р╕Бр╕▓р╕гр╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Гр╕Щ console р╕зр╣Ир╕▓ "Server is running on http://localhost:3000"

ЁЯФ╢ **ЁЯПа р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╣Бр╕Ър╕Ър╕Ър╣Йр╕▓р╕Щр╣Бр╕ер╕░р╕Ир╕Фр╕лр╕бр╕▓р╕в**
- `const app = express();` ЁЯСЙ р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Ър╣Ар╕гр╕▓р╕Бр╕│р╕ер╕▒р╕Зр╕кр╕гр╣Йр╕▓р╕З "р╕Ър╣Йр╕▓р╕Щр╣Ар╕Ыр╕ер╣Ир╕▓р╣Ж" р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡р╕лр╣Йр╕нр╕З р╣Др╕бр╣Ир╕бр╕╡р╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ
- `app.listen(PORT)` ЁЯСЙ р╕Др╕╖р╕нр╕Бр╕▓р╕г **р╕Ър╕нр╕Бр╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╕Ър╣Йр╕▓р╕Щ (р╕Ър╣Йр╕▓р╕Щр╣Ар╕ер╕Вр╕Чр╕╡р╣И)** р╣Гр╕лр╣Йр╕Др╕Щр╕нр╕╖р╣Ир╕Щр╕гр╕╣р╣Йр╕зр╣Ир╕▓р╕Ир╕░р╕бр╕▓р╕лр╕▓р╣Ар╕гр╕▓р╕Чр╕╡р╣Ир╕Юр╕нр╕гр╣Мр╕Хр╣Др╕лр╕Щ р╣Ар╕Кр╣Ир╕Щ `localhost:3000`
- р╣Ар╕бр╕╖р╣Ир╕нр╕Ър╣Йр╕▓р╕Щр╕Юр╕гр╣Йр╕нр╕бр╣Бр╕ер╕░р╕бр╕╡р╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╣Бр╕ер╣Йр╕з р╕Бр╣Зр╕кр╕▓р╕бр╕▓р╕гр╕Ц **р╣Ар╕Ыр╕┤р╕Фр╕гр╕▒р╕Ър╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Ир╕▓р╕Бр╣Ар╕Юр╕╖р╣Ир╕нр╕Щр╕Ър╣Йр╕▓р╕Щ (Client)** р╣Др╕Фр╣Йр╣Бр╕ер╣Йр╕з

---

### **4.2 р╕гр╕▒р╕Ъ HTTP Request**
р╣Гр╕Щр╕кр╣Ир╕зр╕Щр╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Ир╕░р╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Йр╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╕гр╕▒р╕Ъ HTTP Request р╣Вр╕Фр╕вр╣Гр╕Кр╣Й Express

```javascript
app.[р╕Кр╕╖р╣Ир╕н HTTP Method] ([path], [handler function])
```

р╕Лр╕╢р╣Ир╕З handler function р╕нр╕▓р╕Ир╕Ир╕░р╕бр╕╡ 2 р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Др╕╖р╕н

- **Normal Function**
```javascript
function handlerFunction(req, res) {
  res.send('Hello World');
}

app.get('/api/user', handlerFunction);
```

- **Arrow Function**
```javascript
app.get('/api/user', (req, res) => {
  res.send('Hello World');
});
```

р╣Вр╕Фр╕в Function р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щр╕Ир╕░р╕бр╕╡ 2 parameter р╕Др╕╖р╕н
- **req**: р╕Др╕╖р╕н Request Object р╕Чр╕╡р╣Ир╣Ар╕Бр╣Зр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Вр╕нр╕Зр╕Др╕│р╕гр╣Йр╕нр╕Зр╕Вр╕нр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╕Ир╕▓р╕Б _[[Client]]_
- **res**: р╕Др╕╖р╕н Response Object р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕вр╕▒р╕З _[[Client]]_

ЁЯФ╢ **ЁЯПатЬЙя╕П р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╣Бр╕Ър╕Ър╕Ър╣Йр╕▓р╕Щ-р╕лр╣Йр╕нр╕З-р╕Ир╕Фр╕лр╕бр╕▓р╕в**
- `app.get("/")` ЁЯСЙ р╕Др╕╖р╕нр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З "р╕лр╣Йр╕нр╕Зр╕гр╕▒р╕Ър╣Бр╕Вр╕Б" р╣Гр╕Щр╕Ър╣Йр╕▓р╕Щр╕Вр╕нр╕Зр╣Ар╕гр╕▓ р╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З `/`
- `"GET"` ЁЯСЙ р╕Др╕╖р╕нр╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕бр╕▓р╕лр╣Йр╕нр╕Зр╕Щр╕╡р╣Й р╣Ар╕Кр╣Ир╕Щ тАЬр╣Ар╕Вр╕╡р╕вр╕Щр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕бр╕▓р╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕лр╣Йр╕нр╕Зр╕гр╕▒р╕Ър╣Бр╕Вр╕БтАЭ
- `res.send(...)` ЁЯСЙ р╕Др╕╖р╕нр╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Ир╕▓р╕Бр╕лр╣Йр╕нр╕Зр╕Щр╕▒р╣Йр╕Щ р╕зр╣Ир╕▓р╕Ир╕░р╕кр╣Ир╕Зр╕нр╕░р╣Др╕гр╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╣Ар╕Вр╣Йр╕▓р╕бр╕▓

ЁЯУМ р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╕Цр╣Йр╕▓р╣Ар╕гр╕▓р╕бр╕╡р╣Вр╕Др╣Йр╕Фр╣Бр╕Ър╕Ър╕Щр╕╡р╣Й:

```javascript
app.get("/", (req, res) => {
  res.send("Hello World from GET request!");
});
```

р╕Ир╕░р╕лр╕бр╕▓р╕вр╕Др╕зр╕▓р╕бр╕зр╣Ир╕▓
> "р╕Цр╣Йр╕▓р╕бр╕╡р╕Др╕Щр╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╣Бр╕Ър╕Ъ **GET** р╕бр╕▓р╕Чр╕╡р╣Ир╕Ър╣Йр╕▓р╕Щр╕Вр╕нр╕Зр╣Ар╕гр╕▓ (р╕Чр╕╡р╣И `localhost:3000`) р╣Бр╕ер╕░р╣Ар╕Ир╕▓р╕░р╕Ир╕Зр╕бр╕▓р╕Чр╕╡р╣И **р╕лр╣Йр╕нр╕Зр╕гр╕▒р╕Ър╣Бр╕Вр╕Б `/`**,
> р╣Ар╕гр╕▓р╕Ир╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓ **'Hello World from GET request!'**"

ЁЯОп р╕кр╕гр╕╕р╕Ы:
- р╕Ър╣Йр╕▓р╕Щ = `app`
- р╕лр╣Йр╕нр╕З = endpoint р╣Ар╕Кр╣Ир╕Щ `/`, `/api/user`
- р╕Ир╕Фр╕лр╕бр╕▓р╕в = HTTP Request
- р╕зр╕┤р╕Шр╕╡р╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕в = Method (GET, POST, PUT, DELETE)
- р╕Бр╕▓р╕гр╣Ар╕Ыр╕┤р╕Фр╕Ър╣Йр╕▓р╕Щр╣Гр╕лр╣Йр╕Др╕Щр╕бр╕▓р╕лр╕▓р╣Др╕Фр╣Й = `app.listen(...)`

![[20250331-2234-58.4582297.mp4]]
## **5. р╣Гр╕Кр╣Й Environment Variables**

р╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Ир╕▓р╕Бр╕Ър╕▓р╕Зр╕Др╕гр╕▒р╣Йр╕Зр╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Ар╕Бр╣Зр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щр╕Др╕зр╕▓р╕бр╕ер╕▒р╕Ъ р╣Ар╕Кр╣Ир╕Щ р╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ, Token, р╕лр╕гр╕╖р╕н URL р╕Вр╕нр╕З Database р╕Лр╕╢р╣Ир╕Зр╣Др╕бр╣Ир╕Др╕зр╕гр╣Ар╕Бр╣Зр╕Ър╣Др╕зр╣Йр╣Гр╕Щр╣Вр╕Др╣Йр╕Фр╣Вр╕Фр╕вр╕Хр╕гр╕З р╕лр╕гр╕╖р╕н р╕Ър╕▓р╕Зр╕Хр╕▒р╕зр╣Бр╕Ыр╕гр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Гр╕лр╣Йр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕Зр╣Др╕Фр╣Йр╕Хр╕▓р╕бр╕кр╕ар╕▓р╕Юр╣Бр╕зр╕Фр╕ер╣Йр╕нр╕бр╣Ар╕Кр╣Ир╕Щ р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕гр╕▓ deploy р╕Вр╕╢р╣Йр╕Щ server р╕Ир╕гр╕┤р╕Зр╣Ж р╣Ар╕гр╕▓р╕нр╕▓р╕Ир╕Ир╕░р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Гр╕лр╣Й URL р╕Вр╕нр╕З Database р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Др╕Ыр╕Ир╕▓р╕Б localhost р╣Ар╕Ыр╣Зр╕Щ IP Address р╕Вр╕нр╕З Server р╕Ир╕гр╕┤р╕Зр╣Ж р╕лр╕гр╕╖р╕нр╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Ир╕▓р╕Б Development р╣Ар╕Ыр╣Зр╕Щ Production р╣Ар╕гр╕▓р╕нр╕▓р╕Ир╕Ир╕░р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Гр╕лр╣Й PORT р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Др╕Ыр╕Ир╕▓р╕Б 3000 р╣Ар╕Ыр╣Зр╕Щ 80 р╕лр╕гр╕╖р╕н 443 р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕Щ
р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Ар╕гр╕▓р╕Ир╕╢р╕Зр╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Й Environment Variables р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Бр╣Зр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕лр╕ер╣Ир╕▓р╕Щр╕╡р╣Й р╣Вр╕Фр╕вр╣Ар╕гр╕▓р╕Ир╕░р╣Гр╕Кр╣Й package р╕Чр╕╡р╣Ир╕Кр╕╖р╣Ир╕нр╕зр╣Ир╕▓ `dotenv` р╣Гр╕Щр╕Бр╕▓р╕гр╣Вр╕лр╕ер╕Ф Environment Variables р╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М `.env` р╣Ар╕Вр╣Йр╕▓р╕бр╕▓р╣Гр╕Щ process.env
### **5.1 р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З dotenv**
р╕Юр╕┤р╕бр╕Юр╣Мр╕Др╕│р╕кр╕▒р╣Ир╕З

```bash
npm install dotenv
```

### **5.2 р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М .env**
р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М .env р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М backend

.env
```env
PORT=3000
```

### **5.3 р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ Environment Variables**
р╣Гр╕Щр╣Др╕Яр╕ер╣М index.js р╣Гр╕лр╣Й import package dotenv р╕Вр╕╢р╣Йр╕Щр╕бр╕▓ р╣Бр╕ер╕░р╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Йр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ config() р╣Ар╕Юр╕╖р╣Ир╕нр╣Вр╕лр╕ер╕Ф Environment Variables р╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М .env р╣Ар╕Вр╣Йр╕▓р╕бр╕▓р╣Гр╕Щ process.env

```javascript
//index.js
import express from "express";
import dotenv from "dotenv";
dotenv.config();
const app = express();
const PORT = process.env.PORT || 3000;

app.get("/", (req, res) => {
  res.send("Hello World from GET request!");
});
app.get("/api/user", (req, res) => {
  res.send("Hello World from GET request!");
});

app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
});
```


![[20250331-2253-26.3410778.mp4]]


## **6. р╣Ар╕Вр╕╡р╕вр╕Щр╣Вр╕Др╣Йр╕Фр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Бр╕▒р╕Ъ Database**
### **6.1 р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З pg**
р╕Юр╕┤р╕бр╕Юр╣Мр╕Др╕│р╕кр╕▒р╣Ир╕З
pg р╕Др╕╖р╕н package р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Бр╕▒р╕Ъ PostgreSQL Database

```bash
npm install pg
```
### **6.2 р╕кр╕гр╣Йр╕▓р╕З Folder р╕Кр╕╖р╣Ир╕н config р╣Бр╕ер╕░р╕Вр╣Йр╕▓р╕Зр╣Гр╕Щр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М database.js**

![[Pasted image 20250401061446.png]]

database.js
```javascript
//database.js
import pg from "pg";
import dotenv from "dotenv";

dotenv.config();


export const pool = new pg.Pool({ connectionString: process.env.DATABASE_URL });

export const query = async (text, params) => {

┬а const start = Date.now();

┬а const res = await pool.query(text, params);

┬а const duration = Date.now() - start;

┬а console.log("executed query", { text, duration, rows: res.rowCount });

┬а return res;

};
```

р╣Гр╕Щ .env р╣Гр╕лр╣Йр╣Ар╕Юр╕┤р╣Ир╕б DATABASE_URL р╕Фр╣Йр╕зр╕вр╕Др╣Ир╕▓р╕Щр╕╡р╣Й
```env
PORT=3000
DATABASE_URL=postgres://admin:password@localhost:5432/taskmanagement
```

![[20250331-2317-13.2749414.mp4]]

### **6.3 р╕Чр╕Фр╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Хр╣Ир╕н Database р╕кр╕│р╣Ар╕гр╣Зр╕Ир╕лр╕гр╕╖р╕нр╣Др╕бр╣И**

р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М test.js р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М backend

![[Pasted image 20250401110304.png]]

test.js
```javascript
//test.js
import { pool } from "./config/database.js";
import dotenv from "dotenv";

dotenv.config();
export const testConnection = async () => {
  ┬а try {
    ┬а ┬а const client = await pool.connect();
    ┬а ┬а console.log("Connected to the database");
    ┬а ┬а client.release();
    ┬а } catch (err) {
     ┬а console.error("Error connecting to the database", err);
    ┬а }
};

```

р╣Бр╕ер╣Йр╕зр╣Гр╕Щ index.js р╣Гр╕лр╣Йр╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Йр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ testConnection() р╣Гр╕Щ app.listen()
```javascript
//index.js
import express from "express";
import dotenv from "dotenv";
import { testConnection } from "./test.js";

dotenv.config();
const app = express();
const PORT = process.env.PORT || 3000;

app.get("/", (req, res) => {
  res.send("Hello World from GET request!");
});

app.get("/api", (req, res) => {
  res.send("Hello World from API GET request!");
});

app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
  testConnection();
});


```

![[Screen Recording 2025-04-01 111039.mp4]]

р╕Цр╣Йр╕▓р╕Вр╕╢р╣Йр╕Щр╕зр╣Ир╕▓ "Connected to the database" р╣Бр╕кр╕Фр╕Зр╕зр╣Ир╕▓р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Бр╕▒р╕Ъ Database р╕кр╕│р╣Ар╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕з
р╕Цр╣Йр╕▓р╕Вр╕╢р╣Йр╕Щр╕зр╣Ир╕▓ Error р╣Гр╕лр╣Йр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ Docker р╕гр╕▒р╕Щр╕нр╕вр╕╣р╣Ир╕лр╕гр╕╖р╕нр╣Ар╕Ыр╕ер╣Ир╕▓ р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╣Др╕Фр╣Йр╣Гр╕лр╣Йр╕гр╕▒р╕Щр╣Гр╕лр╣Йр╣Др╕Ыр╕Чр╕│ [[Start Point#^4e71ae| р╣Ар╕Ыр╕┤р╕Ф Docker]]

## 7. р╕кр╕гр╣Йр╕▓р╕З Router р╣Бр╕ер╕░ Controller

Router р╕Др╕╖р╕нр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕кр╣Йр╕Щр╕Чр╕▓р╕Зр╕Вр╕нр╕З URL р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Гр╕лр╣Й _[[Server]]_ р╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╕Хр╣Ир╕н _[[Client]]_ р╣Вр╕Фр╕вр╣Ар╕гр╕▓р╕Ир╕░р╕кр╕гр╣Йр╕▓р╕З Router р╣Бр╕вр╕Бр╕Хр╕▓р╕бр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ р╣Ар╕Кр╣Ир╕Щ User, Project, Task, Attachment, Project Member, Task Assignee
р╣Ар╕лр╕Хр╕╕р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╣Бр╕вр╕Б Router р╕нр╕нр╕Бр╣Др╕Ыр╣Ар╕Ыр╣Зр╕Щр╣Др╕Яр╕ер╣Мр╕Хр╣Ир╕▓р╕Зр╣Ж р╣Ар╕Юр╕гр╕▓р╕░р╕зр╣Ир╕▓р╣Ар╕бр╕╖р╣Ир╕нр╣Бр╕нр╕Ыр╕Юр╕ер╕┤р╣Ар╕Др╕Кр╕▒р╕Щр╕бр╕╡р╕Вр╕Щр╕▓р╕Фр╣Гр╕лр╕Нр╣Ир╕Вр╕╢р╣Йр╕Щ URL р╕Ир╕░р╕бр╕╡р╕Др╕зр╕▓р╕бр╕Лр╕▒р╕Ър╕Лр╣Йр╕нр╕Щр╕бр╕▓р╕Бр╕Вр╕╢р╣Йр╕Щр╣Бр╕ер╕░р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕г Router р╣Гр╕Щр╣Др╕Яр╕ер╣Мр╣Ар╕Фр╕╡р╕вр╕зр╕нр╕▓р╕Ир╕Чр╕│р╣Гр╕лр╣Йр╣Вр╕Др╣Йр╕Фр╕вр╕╕р╣Ир╕Зр╣Ар╕лр╕вр╕┤р╕Зр╣Др╕Фр╣Й
р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Ар╕гр╕▓р╕Ир╕╢р╕Зр╕Др╕зр╕гр╣Бр╕вр╕Б Router р╕нр╕нр╕Бр╣Др╕Ыр╣Ар╕Ыр╣Зр╕Щр╣Др╕Яр╕ер╣Мр╕Хр╣Ир╕▓р╕Зр╣Ж р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╣Вр╕Др╣Йр╕Фр╕нр╣Ир╕▓р╕Щр╕Зр╣Ир╕▓р╕вр╣Бр╕ер╕░р╕Фр╕╣р╣Бр╕ер╕гр╕▒р╕Бр╕йр╕▓р╕Зр╣Ир╕▓р╕вр╕Вр╕╢р╣Йр╕Щ

ЁЯФ╢ **ЁЯПа р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╣Бр╕Ър╕Ър╕Ър╣Йр╕▓р╕Щ тАУ Router р╕Др╕╖р╕нр╣Вр╕Цр╕Зр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕Щ**
- р╕ер╕нр╕Зр╕Щр╕╢р╕Бр╕зр╣Ир╕▓ `app` р╕Др╕╖р╕нр╕Ър╣Йр╕▓р╕Щр╕лр╕ер╕▒р╕Зр╕лр╕Щр╕╢р╣Ир╕З
- р╣Гр╕Щр╕Ър╣Йр╕▓р╕Щр╕бр╕╡р╕лр╕ер╕▓р╕в "р╕лр╣Йр╕нр╕З" (endpoint) р╣Ар╕Кр╣Ир╕Щ р╕лр╣Йр╕нр╕З user, р╕лр╣Йр╕нр╕З project, р╕лр╣Йр╕нр╕З task
- р╕Бр╕▓р╕гр╣Ар╕Вр╕╡р╕вр╕Щ Route р╣Бр╕Ър╕Ър╕Хр╕гр╕Зр╣Ж р╣Гр╕Щ `index.js` р╕Др╕╖р╕нр╕Бр╕▓р╕г тАЬр╣Ар╕нр╕▓р╕Ыр╕гр╕░р╕Хр╕╣р╣Бр╕Хр╣Ир╕ер╕░р╕лр╣Йр╕нр╕Зр╣Др╕Ыр╕зр╕▓р╕Зр╣Др╕зр╣Йр╕Бр╕ер╕▓р╕Зр╕Ър╣Йр╕▓р╕ЩтАЭ р╕Лр╕╢р╣Ир╕Зр╕Юр╕нр╕лр╣Йр╕нр╕Зр╣Ар╕вр╕нр╕░р╕Вр╕╢р╣Йр╕Щ р╕Ър╣Йр╕▓р╕Щр╕Бр╣Зр╕Ир╕░р╕гр╕Бр╕гр╕╕р╕Зр╕гр╕▒р╕З
- р╣Бр╕Хр╣Ир╕Цр╣Йр╕▓р╣Ар╕гр╕▓р╣Гр╕Кр╣Й `Router` р╕Бр╣Зр╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З "р╣Вр╕Цр╕Зр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕Щ" р╕Чр╕╡р╣Ир╣Бр╕вр╕Бр╣Бр╕Хр╣Ир╕ер╕░р╕лр╣Йр╕нр╕Зр╣Др╕зр╣Йр╣Ар╕Ыр╣Зр╕Щр╕кр╕▒р╕Фр╕кр╣Ир╕зр╕Щ р╣Ар╕Кр╣Ир╕Щ `userRouter`, `taskRouter`
- р╕Ир╕▓р╕Бр╕Щр╕▒р╣Йр╕Щр╣Вр╕Цр╕Зр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕Щр╣Бр╕Хр╣Ир╕ер╕░р╕кр╕▓р╕вр╕Бр╣Зр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Бр╕▒р╕Ър╕лр╣Йр╕нр╕Зр╕Щр╕▒р╣Йр╕Щр╣Ж р╣Др╕Ыр╕нр╕╡р╕Бр╕Чр╕╡

---

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╣Гр╕Кр╣Й Router
р╕кр╕бр╕бр╕Хр╕┤р╕зр╣Ир╕▓р╣Ар╕гр╕▓р╕бр╕╡ API р╕Чр╕╡р╣Ир╕бр╕╡р╕лр╕ер╕▓р╕в Endpoint р╣Бр╕ер╕░ Endpoint р╕Щр╕▒р╣Йр╕Щр╕вр╕▓р╕зр╕бр╕▓р╕Бр╣Ж р╣Ар╕Кр╣Ир╕Щ

```javascript
//index.js
import express from "express";
import dotenv from "dotenv";
import { testConnection } from "./test.js";

dotenv.config();
const app = express();
const PORT = process.env.PORT || 3000;

app.get("/", (req, res) => {
  res.send("Hello World from GET request!");
});

app.get("/api/v1/user", (req, res) => {
  res.send("Hello World from API GET request!");
});

app.post("/api/v1/user", (req, res) => {
  res.send("Hello World from API POST request!");
});

app.put("/api/v1/user", (req, res) => {
  res.send("Hello World from API PUT request!");
});

app.delete("/api/v1/user", (req, res) => {
  res.send("Hello World from API DELETE request!");
});

app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
  testConnection();
});
```

р╕Лр╕╢р╣Ир╕Зр╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╣Гр╕Кр╣Й Router
```javascript
//index.js
import express from "express";
import dotenv from "dotenv";
import { testConnection } from "./test.js";
import userRouter from "./userRouter.js";

dotenv.config();
const app = express();
const PORT = process.env.PORT || 3000;

app.get("/", (req, res) => {
  res.send("Hello World from GET request!");
});

app.use("/api/v1/user", userRouter); // р╣Вр╕Цр╕Зр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕Щр╕Чр╕╡р╣Ир╕Юр╕▓р╣Др╕Ыр╕вр╕▒р╕З "р╕лр╣Йр╕нр╕З user"

app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
  testConnection();
});
```

```javascript
// userRouter.js р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Чр╕╡р╣И 1
import express from "express";
const userRouter = express.Router();

userRouter.get("/", (req, res) => {
  res.send("Hello World from API GET request!");
});
userRouter.post("/", (req, res) => {
  res.send("Hello World from API POST request!");
});
userRouter.put("/", (req, res) => {
  res.send("Hello World from API PUT request!");
});
userRouter.delete("/", (req, res) => {
  res.send("Hello World from API DELETE request!");
});

export default userRouter;
```

р╕лр╕гр╕╖р╕нр╕Ир╕░р╣Ар╕Ыр╣Зр╕Щр╣Бр╕Ър╕Ър╕Щр╕╡р╣Йр╕Бр╣Зр╣Др╕Фр╣Й
```javascript
// userRouter.js р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Чр╕╡р╣И 2
import express from "express";
const userRouter = express.Router();

userRouter.route("/")
  .get((req, res) => {
    res.send("Hello World from API GET request!");
  })
  .post((req, res) => {
    res.send("Hello World from API POST request!");
  })
  .put((req, res) => {
    res.send("Hello World from API PUT request!");
  })
  .delete((req, res) => {
    res.send("Hello World from API DELETE request!");
  });

export default userRouter;
```

р╣Ар╕лр╣Зр╕Щр╣Др╕Фр╣Йр╕зр╣Ир╕▓р╣Ар╕гр╕▓р╕Щр╕▒р╣Йр╕Щр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕З р╕бр╕▓р╣Ар╕Вр╕╡р╕вр╕Щ "/api/v1/user" р╕Лр╣Йр╕│р╣Ж р╕лр╕ер╕▓р╕вр╣Ж р╕Др╕гр╕▒р╣Йр╕З
р╣Бр╕ер╕░р╕вр╕▒р╕Зр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Ир╕▒р╕Фр╕Бр╕▓р╕г Route р╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕вр╕Вр╕╢р╣Йр╕Щ

---

р╕Хр╣Ир╕нр╣Др╕Ыр╕Др╕╖р╕н **Controller**

Controller р╕Др╕╖р╕нр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕г Logic р╕Вр╕нр╕З API р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Гр╕лр╣Й _[[Server]]_ р╕Чр╕│р╕Зр╕▓р╕Щ р╣Ар╕Кр╣Ир╕Щ р╕Бр╕▓р╕гр╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Database, р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕е, р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕вр╕▒р╕З _[[Client]]_

ЁЯФ╢ **ЁЯзСтАНЁЯН│ р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╕Др╕Щр╣Гр╕Щр╕лр╣Йр╕нр╕Зр╕Чр╕╡р╣Ир╕Чр╕│р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╣Ар╕Йр╕Юр╕▓р╕░р╕Чр╕▓р╕З**
- Router р╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Вр╕Цр╕Зр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕Щр╕Чр╕╡р╣Ир╕Юр╕▓р╣Ар╕гр╕▓р╣Др╕Ыр╕Цр╕╢р╕З тАЬр╕лр╣Йр╕нр╕Зр╕Хр╣Ир╕▓р╕Зр╣ЖтАЭ
- Controller р╕Др╕╖р╕н тАЬр╕Др╕Щр╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕лр╣Йр╕нр╕Зр╕Щр╕▒р╣Йр╕Щр╣ЖтАЭ р╕Чр╕╡р╣Ир╕гр╕▒р╕Ър╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Бр╕ер╕░р╕Чр╕│р╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З р╣Ар╕Кр╣Ир╕Щ р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
- р╕Цр╣Йр╕▓р╣Ар╕гр╕▓р╕вр╕▒р╕Ф logic р╣Др╕зр╣Йр╣Гр╕Щ Router р╣Вр╕Фр╕вр╕Хр╕гр╕З р╕Бр╣Зр╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Ар╕гр╕▓р╕бр╕╡ тАЬр╕Др╕Щр╕Чр╕│р╕Зр╕▓р╕Щр╣Ар╕Хр╣Зр╕бр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕ЩтАЭ р╕Чр╕│р╣Гр╕лр╣Йр╕Ър╣Йр╕▓р╕Щр╕гр╕Бр╣Бр╕ер╕░р╕Фр╕╣р╣Бр╕ер╕вр╕▓р╕Б
- р╕Цр╣Йр╕▓р╣Бр╕вр╕Бр╣Ар╕Ыр╣Зр╕Щ Controller р╕Бр╣Зр╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Гр╕лр╣Й "р╕Юр╕Щр╕▒р╕Бр╕Зр╕▓р╕Щр╣Бр╕Хр╣Ир╕ер╕░р╕Др╕Щр╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕лр╣Йр╕нр╕Зр╕Вр╕нр╕Зр╕Хр╕▒р╕зр╣Ар╕нр╕З" р╣Бр╕ер╕░р╣Вр╕Цр╕Зр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕Щр╕Бр╣Зр╣Бр╕Др╣Ир╕Юр╕▓р╣Ар╕гр╕▓р╣Др╕Ыр╕лр╕▓р╣Ар╕Вр╕▓

р╕Ир╕▓р╕Бр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Вр╣Йр╕▓р╕Зр╕Ър╕Щ
```javascript
// userRouter.js р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Чр╕╡р╣И 1
import express from "express";
const userRouter = express.Router();

userRouter.get("/", (req, res) => {
  res.send("Hello World from API GET request!");
});
userRouter.post("/", (req, res) => {
  res.send("Hello World from API POST request!");
});
userRouter.put("/", (req, res) => {
  res.send("Hello World from API PUT request!");
});
userRouter.delete("/", (req, res) => {
  res.send("Hello World from API DELETE request!");
});

export default userRouter;
```

р╣Ар╕гр╕▓р╕Ир╕░р╣Ар╕лр╣Зр╕Щр╕зр╣Ир╕▓ Logic р╕Вр╕нр╕З API р╕Щр╕▒р╣Йр╕Щр╕нр╕вр╕╣р╣Ир╣Гр╕Щ Router р╕Лр╕╢р╣Ир╕Зр╕Чр╕│р╣Гр╕лр╣Йр╣Вр╕Др╣Йр╕Фр╕Фр╕╣р╕вр╕╕р╣Ир╕Зр╣Ар╕лр╕вр╕┤р╕Зр╣Бр╕ер╕░р╕нр╣Ир╕▓р╕Щр╕вр╕▓р╕Б
р╣Ар╕гр╕▓р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Бр╕вр╕Б Logic (arrow function) р╕нр╕нр╕Бр╣Др╕Ыр╣Ар╕Ыр╣Зр╕Щ Controller р╣Др╕Фр╣Й р╣Вр╕Фр╕вр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣Мр╣Бр╕вр╕Бр╕нр╕нр╕Бр╣Др╕Ы р╣Ар╕Кр╣Ир╕Щ userController.js

```javascript
// userController.js
export const getUser = (req, res) => {
  res.send("Hello World from API GET request!");
};

export const createUser = (req, res) => {
  res.send("Hello World from API POST request!");
};

export const updateUser = (req, res) => {
  res.send("Hello World from API PUT request!");
};

export const deleteUser = (req, res) => {
  res.send("Hello World from API DELETE request!");
};
```

р╣Бр╕ер╣Йр╕зр╣Гр╕Щ userRouter.js р╣Гр╕лр╣Й import р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Ир╕▓р╕Б userController.js р╕бр╕▓р╣Гр╕Кр╣Й
```javascript
// userRouter.js
import express from "express";
import { getUser, createUser, updateUser, deleteUser } from "./userController.js";

const userRouter = express.Router();

userRouter.get("/", getUser);
userRouter.post("/", createUser);
userRouter.put("/", updateUser);
userRouter.delete("/", deleteUser);

export default userRouter;
```

ЁЯОп р╕кр╕гр╕╕р╕Ы:
- `Router` = р╣Вр╕Цр╕Зр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕Щр╣Гр╕Щр╕Ър╣Йр╕▓р╕Щ
- `Endpoint` = р╕лр╣Йр╕нр╕Зр╣Бр╕Хр╣Ир╕ер╕░р╕лр╣Йр╕нр╕З
- `Method` = р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╣Др╕Ыр╕вр╕▒р╕Зр╕лр╣Йр╕нр╕З (GET, POST, PUT, DELETE)
- `Controller` = р╕Др╕Щр╣Гр╕Щр╕лр╣Йр╕нр╕Зр╕Чр╕╡р╣Ир╕гр╕▒р╕Ър╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Бр╕ер╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ

### **7.1 р╕кр╕гр╣Йр╕▓р╕З Folder р╕Кр╕╖р╣Ир╕н routes**
р╕кр╕гр╣Йр╕▓р╕З Folder р╕Кр╕╖р╣Ир╕н routes р╣Бр╕ер╕░ Folder р╕Кр╕╖р╣Ир╕н controllers р╣Гр╕Щ backend

![[Pasted image 20250401114259.png]]

### **7.2 р╣Ар╕Фр╕╡р╣Лр╕вр╕зр╕Юр╕▓р╕Чр╕│р╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ъ User р╣Бр╕ер╕░ Authentication р╕Бр╣Ир╕нр╕Щ**
р╣Вр╕нр╣Ар╕Д! р╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Ир╕░р╕Чр╕│р╕кр╣Ир╕зр╕Щр╕Вр╕нр╕З User р╕Бр╣Ир╕нр╕Щр╕Щр╕░

р╣Вр╕Фр╕в User р╕Др╕зр╕гр╕Ир╕░р╕бр╕╡р╕Бр╕▓р╕гр╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ (Register) р╣Бр╕ер╕░р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ (Login)
- р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ (Register) р╕Др╕╖р╕нр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╕Ър╕▒р╕Нр╕Кр╕╡р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Гр╕лр╕бр╣И
- р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ (Login) р╕Др╕╖р╕нр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕бр╕╡р╕Ър╕▒р╕Нр╕Кр╕╡р╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕лр╕гр╕╖р╕нр╣Др╕бр╣И
(- р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕гр╕░р╕Ър╕Ъ (Logout) р╕Др╕╖р╕нр╕Бр╕▓р╕гр╕Чр╕│р╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╣Ир╕зр╕Щр╕Хр╕▒р╕зр╣Др╕Фр╣Йр╕нр╕╡р╕Бр╕Хр╣Ир╕нр╣Др╕Ы р╣Бр╕Хр╣Ир╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Ар╕Ыр╣Зр╕Щр╕кр╣Ир╕зр╕Щр╕Вр╕нр╕З Frontend)

р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Ар╕гр╕▓р╕Ир╕░р╕кр╕гр╣Йр╕▓р╕З Router р╣Бр╕ер╕░ Controller р╕кр╕│р╕лр╕гр╕▒р╕Ъ User р╕Вр╕╢р╣Йр╕Щр╕бр╕▓
р╣Вр╕Фр╕вр╣Ар╕гр╕▓р╕Ир╕░р╕кр╕гр╣Йр╕▓р╕З Router р╣Вр╕Фр╕вр╕Др╕┤р╕Фр╕Бр╣Ир╕нр╕Щр╕зр╣Ир╕▓р╣Ар╕гр╕▓р╕Ир╕░р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Чр╕│р╕нр╕░р╣Др╕гр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ъ User р╕Ър╣Йр╕▓р╕З
р╣Гр╕Щр╕Чр╕╡р╣Ир╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Ир╕░р╕бр╕╡р╕Бр╕▓р╕гр╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ (Register) р╣Бр╕ер╕░р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ (Login)

ЁЯФ╢ **ЁЯзСтАНЁЯН│ р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╕Др╕Щр╣Гр╕Щр╕лр╣Йр╕нр╕Зр╕Чр╕╡р╣Ир╕Чр╕│р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╣Ар╕Йр╕Юр╕▓р╕░р╕Чр╕▓р╕З**
- Router р╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Вр╕Цр╕Зр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕Щр╕Чр╕╡р╣Ир╕Юр╕▓р╣Ар╕гр╕▓р╣Др╕Ыр╕Цр╕╢р╕З тАЬр╕лр╣Йр╕нр╕Зр╕Хр╣Ир╕▓р╕Зр╣ЖтАЭ
- Controller р╕Др╕╖р╕н тАЬр╕Др╕Щр╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕лр╣Йр╕нр╕Зр╕Щр╕▒р╣Йр╕Щр╣ЖтАЭ р╕Чр╕╡р╣Ир╕гр╕▒р╕Ър╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Бр╕ер╕░р╕Чр╕│р╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З р╣Ар╕Кр╣Ир╕Щ р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й

**р╣Вр╕Фр╕вр╕Ър╣Йр╕▓р╕Щр╕лр╕ер╕▒р╕Бр╣Ар╕гр╕▓р╕нр╕вр╕╣р╣Ир╕Чр╕╡р╣Ир╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З  (starting point of server):**
```
http://localhost:3000/
```


**р╣Ар╕гр╕▓р╕бр╕╡р╣Вр╕Цр╕Зр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕Щр╕Чр╕╡р╣Ир╕Юр╕▓р╣Ар╕гр╕▓р╕бр╕▓р╕лр╣Йр╕нр╕Зр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ъ User (authRouter):**
```
/api/v1/auth/
```


**р╣Гр╕Щр╣Вр╕Цр╕Зр╕Чр╕▓р╕Зр╣Ар╕Фр╕┤р╕Щр╕Щр╕╡р╣Й (/api/v1/auth/) р╕бр╕╡р╕лр╣Йр╕нр╕Зр╕вр╣Ир╕нр╕вр╣Ж р╕Чр╕╡р╣Ир╕Чр╕│р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╕Хр╣Ир╕▓р╕Зр╕Бр╕▒р╕Щр╕Др╕╖р╕н (authRouter)**

- р╕лр╣Йр╕нр╕Зр╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ (Register): р╕Чр╕╡р╣Ир╕бр╕╡р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕лр╣Йр╕нр╕Зр╕Др╕╖р╕н POST
```
/register
```

- р╕лр╣Йр╕нр╕Зр╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ (Login): р╕Чр╕╡р╣Ир╕бр╕╡р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕лр╣Йр╕нр╕Зр╕Др╕╖р╕н POST
```
/login
```


р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Ар╕кр╣Йр╕Щр╕Чр╕▓р╕Зр╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕Ыр╕ер╕▓р╕вр╕Чр╕▓р╕Зр╕Вр╕нр╕З Http Request р╕лр╕гр╕╖р╕нр╕Лр╕нр╕Зр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Ир╕░р╕кр╣Ир╕Зр╣Др╕Ыр╕вр╕▒р╕Зр╕лр╣Йр╕нр╕Зр╕Хр╣Ир╕▓р╕Зр╣Ж р╕Ир╕░р╕бр╕╡р╕ер╕▒р╕Бр╕йр╕Ур╕░р╕Фр╕▒р╕Зр╕Щр╕╡р╣Й
```
POST http://localhost:3000/api/v1/auth/register
POST http://localhost:3000/api/v1/auth/login
```

POST http://localhost:3000/api/v1/auth/register
POST http://localhost:3000/api/v1/auth/login

р╣Ар╕Бр╕гр╣Зр╕Фр╕Др╕зр╕▓р╕бр╕гр╕╣р╣Й р╕Чр╕│р╣Др╕бр╕Хр╣Йр╕нр╕Зр╣Ар╕Ыр╣Зр╕Щ /api/v1/auth/

ЁЯУМ р╕Чр╕│р╣Др╕бр╕Хр╣Йр╕нр╕Зр╕бр╕╡ API Versioning р╣Ар╕Кр╣Ир╕Щ /api/v1/ ?

р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕гр╕▓р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕Юр╕▒р╕Тр╕Щр╕▓ API р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕нр╕Ыр╕лр╕гр╕╖р╕нр╣Ар╕зр╣Зр╕Ър╣Др╕Лр╕Хр╣М р╣Ар╕гр╕▓р╕нр╕▓р╕Ир╕Др╕┤р╕Фр╕зр╣Ир╕▓р╣Ар╕кр╣Йр╕Щр╕Чр╕▓р╕Зр╣Бр╕Ър╕Ър╕Зр╣Ир╕▓р╕в р╣Ж р╣Ар╕Кр╣Ир╕Щ /register р╕лр╕гр╕╖р╕н /login р╕Бр╣Зр╣Ар╕Юр╕╡р╕вр╕Зр╕Юр╕нр╣Бр╕ер╣Йр╕з
р╣Бр╕Хр╣Ир╕Щр╕▒р╣Ир╕Щр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Юр╕╡р╕вр╕Зр╕Ир╕╕р╕Фр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ р╣Ар╕Юр╕гр╕▓р╕░р╣Ар╕бр╕╖р╣Ир╕нр╕гр╕░р╕Ър╕Ър╣Ар╕Хр╕┤р╕Ър╣Вр╕Х р╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕бр╕▓р╕Бр╕Вр╕╢р╣Йр╕Щ р╣Бр╕ер╕░р╕бр╕╡р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕лр╕ер╕▓р╕Бр╕лр╕ер╕▓р╕вр╕Ыр╕гр╕░р╣Ар╕ар╕Ч
р╣Ар╕гр╕▓р╕Ир╕░р╕Хр╣Йр╕нр╕Зр╕бр╕╡р╕Бр╕▓р╕г **р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З** API р╕нр╕вр╕╣р╣Ир╣Ар╕гр╕╖р╣Ир╕нр╕в р╣Ж р╣Ар╕Кр╣Ир╕Щ р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е р╣Ар╕Юр╕┤р╣Ир╕бр╕Яр╕┤р╕ер╕Фр╣Мр╕Ър╕▒р╕Зр╕Др╕▒р╕Ъ р╕лр╕гр╕╖р╕нр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Бр╕гр╕░р╕Ър╕зр╕Щр╕Бр╕▓р╕гр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щ
р╕лр╕▓р╕Бр╣Ар╕гр╕▓р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕Зр╣Вр╕Фр╕вр╣Др╕бр╣Ир╣Бр╕вр╕Бр╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щ р╕Ир╕░р╣Ар╕Бр╕┤р╕Фр╕Ыр╕▒р╕Нр╕лр╕▓р╕Бр╕▒р╕Ър╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Ар╕Фр╕┤р╕бр╕Чр╕▒р╕Щр╕Чр╕╡

тЬЕ API Versioning р╕Др╕╖р╕нр╣Бр╕Щр╕зр╕Чр╕▓р╕Зр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓р╕Щр╕╡р╣Й р╣Вр╕Фр╕вр╕Бр╕▓р╕гр╕Бр╕│р╕лр╕Щр╕Фр╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╣Др╕зр╣Йр╣Гр╕Щ URL р╣Ар╕Кр╣Ир╕Щ /api/v1/
р╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕вр╕Бр╕Др╕зр╕▓р╕бр╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Бр╕ер╕░р╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕нр╕З API р╣Бр╕Хр╣Ир╕ер╕░р╕гр╕╕р╣Ир╕Щр╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕Бр╕▒р╕Щ р╕Чр╕│р╣Гр╕лр╣Йр╕гр╕░р╕Ър╕Ър╕бр╕╡р╕Др╕зр╕▓р╕бр╕вр╕╖р╕Фр╕лр╕вр╕╕р╣Ир╕Щр╣Бр╕ер╕░р╣Ар╕кр╕Цр╕╡р╕вр╕г

тЬЕ р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Ар╕Бр╣Ир╕▓р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Й API р╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╣Ар╕Фр╕┤р╕бр╕Хр╣Ир╕нр╣Др╕Ыр╣Др╕Фр╣Йр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Юр╕▒р╕З
тЬЕ р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Гр╕лр╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Йр╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕ер╣Ир╕▓р╕кр╕╕р╕Фр╣Гр╕Щ API р╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╣Гр╕лр╕бр╣Ир╣Др╕Фр╣Йр╕Чр╕▒р╕Щр╕Чр╕╡

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:
- /api/v1/auth/register => API р╕гр╕╕р╣Ир╕Щр╣Бр╕гр╕Б
- /api/v2/auth/register => API р╕гр╕╕р╣Ир╕Щр╣Гр╕лр╕бр╣Ир╕Чр╕╡р╣Ир╕нр╕▓р╕Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ OAuth, р╕кр╣Ир╕Зр╕гр╕лр╕▒р╕к OTP р╕лр╕гр╕╖р╕нр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣И

тЭМ р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡ API Versioning:
- р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Ар╕Бр╣Ир╕▓р╕Ир╕░р╣Др╕Фр╣Йр╕гр╕▒р╕Ъ Error р╣Ар╕бр╕╖р╣Ир╕н API р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Др╕Ы
- р╣Бр╕нр╕Ыр╣Ар╕Бр╣Ир╕▓р╕Ир╕░р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╕╖р╣Ир╕нр╕кр╕▓р╕гр╕Бр╕▒р╕Ъ Backend р╣Др╕Фр╣Й
- р╕Щр╕▒р╕Бр╕Юр╕▒р╕Тр╕Щр╕▓р╕нр╕▓р╕Ир╕Хр╣Йр╕нр╕Зр╣Ар╕Вр╕╡р╕вр╕Щр╣Вр╕Др╣Йр╕Фр╕Лр╕▒р╕Ър╕Лр╣Йр╕нр╕Щр╣Ар╕Юр╕╖р╣Ир╕нр╕гр╕нр╕Зр╕гр╕▒р╕Ър╕лр╕ер╕▓р╕вр╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╣Гр╕Щ endpoint р╣Ар╕Фр╕╡р╕вр╕з

ЁЯОп р╕кр╕гр╕╕р╕Ы: р╕Бр╕▓р╕гр╕бр╕╡ /api/v1/ р╕Др╕╖р╕нр╕Бр╕▓р╕г "р╕Ир╕▒р╕Фр╕гр╕░р╣Ар╕Ър╕╡р╕вр╕Ъ" р╣Бр╕ер╕░ "р╕зр╕▓р╕Зр╣Бр╕Ьр╕Щр╕нр╕Щр╕▓р╕Др╕Х" р╕Вр╕нр╕Зр╕гр╕░р╕Ър╕Ър╣Гр╕лр╣Йр╣Ар╕Хр╕┤р╕Ър╣Вр╕Хр╣Др╕Фр╣Йр╕нр╕вр╣Ир╕▓р╕Зр╕бр╕▒р╣Ир╕Щр╕Др╕З


#### 7.2.1 р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М authRouter.js р╣Гр╕Щ Folder routes

![[Pasted image 20250402184715.png]]

authRouter.js
```javascript
// authRouter.js
import express from "express";
import { registerUser, loginUser } from "../controllers/authController.js";

const router = express.Router();

router.post("/register", registerUser);
router.post("/login", loginUser);

export default router;
```

#### 7.2.2 р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М authController.js р╣Гр╕Щ Folder controllers
р╣Гр╕Щр╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╕вр╕▒р╕Зр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╣Ар╕Вр╕╡р╕вр╕Щ Logic р╕нр╕░р╣Др╕гр╣Гр╕Щ Controller р╣Ар╕Фр╕╡р╣Лр╕вр╕зр╣Ар╕гр╕▓р╕Ир╕░р╕ер╕нр╕Зр╕Фр╕╣р╕Бр╣Ир╕нр╕Щр╕зр╣Ир╕▓р╕кр╕гр╣Йр╕▓р╕З Router р╣Бр╕ер╕░ Controller р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И р╣Вр╕Фр╕вр╣Гр╕лр╣Йр╕кр╣Ир╕З Response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓ "User registered successfully" р╣Бр╕ер╕░ "User logged in successfully" р╕Бр╣Ир╕нр╕Щ
![[Pasted image 20250402190106.png]]
```javascript
// authController.js
export const registerUser = async (req, res) => {
  res.status(200).send({ message: "User registered successfully" });
};
export const loginUser = async (req, res) => {
  res.status(200).send({ message: "User logged in successfully" });
};
```

#### 7.2.3 р╣Ар╕Юр╕┤р╣Ир╕б authRouter р╣Гр╕Щ index.js
р╣Гр╕Щ index.js р╣Гр╕лр╣Й import authRouter р╣Ар╕Вр╣Йр╕▓р╕бр╕▓р╣Бр╕ер╕░р╣Гр╕Кр╣Й Router р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щ
```javascript
// index.js
import express from "express";
import dotenv from "dotenv";
import { testConnection } from "./test.js";
import authRouter from "./routes/authRouter.js";

dotenv.config();
const app = express();
const PORT = process.env.PORT || 3000;

app.use("/api/v1/auth/", authRouter); // р╣Ар╕Юр╕┤р╣Ир╕б Router р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щ

app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
  testConnection();
});
```


р╣Ар╕Др╣Йр╕▓р╕Ир╕░р╣Гр╕Кр╣Й Postman р╣Гр╕Щр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ API р╕Вр╕нр╕Зр╣Ар╕гр╕▓
Postman р╣Ар╕Ыр╣Зр╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ API р╣Вр╕Фр╕вр╣Ар╕гр╕▓р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Ир╕З Request р╣Др╕Ыр╕вр╕▒р╕З API р╕Вр╕нр╕Зр╣Ар╕гр╕▓р╣Др╕Фр╣Й
Postman р╕Ир╕░р╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Йр╣Ар╕гр╕▓р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Чр╕Фр╕кр╕нр╕Ъ API р╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕вр╕Вр╕╢р╣Йр╕Щ р╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╣Ар╕Вр╕╡р╕вр╕Щ Code р╕Вр╕╢р╣Йр╕Щр╕бр╕▓р╣Ар╕нр╕З
р╣Ар╕Фр╕╡р╣Лр╕вр╕зр╣Ар╕гр╕▓р╕Ир╕░р╕ер╕нр╕Зр╣Гр╕Кр╣Й Post man р╣Ар╕Юр╕╖р╣Ир╕нр╕Чр╕Фр╕кр╕нр╕Ър╕Фр╕╣р╕зр╣Ир╕▓р╣Ар╕гр╕▓р╕кр╕гр╣Йр╕▓р╕З Router р╣Бр╕ер╕░ Controller р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И


#### 7.2.4 р╕Чр╕Фр╕кр╕нр╕Ъ API р╕Фр╣Йр╕зр╕в Postman
- 1. р╕бр╕▒р╣Ир╕Щр╣Гр╕Ир╕зр╣Ир╕▓ Run Docker р╕нр╕вр╕╣р╣И
- 2. р╣Ар╕Ыр╕┤р╕Ф run backend р╕Фр╣Йр╕зр╕в р╕Др╕│р╕кр╕▒р╣Ир╕З
```bash
npm run dev
```
- 3. р╣Ар╕Ыр╕┤р╕Ф Postman р╕Вр╕╢р╣Йр╕Щр╕бр╕▓
- 4. р╕кр╕гр╣Йр╕▓р╕З Request р╣Гр╕лр╕бр╣И р╣Вр╕Фр╕вр╣Ар╕ер╕╖р╕нр╕Б Method р╣Ар╕Ыр╣Зр╕Щ POST
- 5. р╣Гр╕кр╣И URL р╣Ар╕Ыр╣Зр╕Щ
```
http://localhost:3000/api/v1/auth/register
```
- 6. р╕Бр╕Ф Send
- 7. р╕Цр╣Йр╕▓р╕кр╕│р╣Ар╕гр╣Зр╕Ир╕Ир╕░р╣Др╕Фр╣Й Response р╕Бр╕ер╕▒р╕Ър╕бр╕▓р╕зр╣Ир╕▓
```json
{
    "message": "User registered successfully"
}
```

![[Untitled video - Made with Clipchamp.mp4]]

р╕Цр╣Йр╕▓р╕Чр╕│р╕кр╕│р╣Ар╕гр╣Зр╕Ир╕Ир╕░р╣Др╕Фр╣Йр╣Бр╕кр╕Фр╕Зр╕зр╣Ир╕▓ р╣Ар╕гр╕▓р╣Др╕Фр╣Йр╕кр╕гр╣Йр╕▓р╕З Router р╣Бр╕ер╕░ Controller р╕кр╕│р╕лр╕гр╕▒р╕Ъ User р╣Др╕Фр╣Йр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╣Бр╕ер╣Йр╕з
р╣Бр╕Хр╣Ир╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕░р╣Др╕гр╣Др╕Ыр╕вр╕▒р╕З Backend р╣Ар╕ер╕в р╣Ар╕гр╕▓р╕кр╣Ир╕З Request р╣Ар╕Ыр╕ер╣Ир╕▓р╣Ж р╣Др╕Ы
р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Хр╣Ир╕нр╣Др╕Ыр╣Ар╕гр╕▓р╕Ир╕░р╕Хр╣Йр╕нр╕Зр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕Ыр╕вр╕▒р╕З Backend р╕Фр╣Йр╕зр╕в


#### 7.2.5 р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕Ыр╕вр╕▒р╕З Backend
р╣Гр╕Щр╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Ир╕░р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕Ыр╕вр╕▒р╕З Backend р╣Вр╕Фр╕вр╕Бр╕▓р╕гр╣Гр╕Кр╣Й Body р╕Вр╕нр╕З Request
Body р╕Др╕╖р╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╣Др╕Ыр╕вр╕▒р╕З Backend р╣Вр╕Фр╕вр╣Ар╕гр╕▓р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕Фр╣Йр╕лр╕ер╕▓р╕вр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ р╣Ар╕Кр╣Ир╕Щ JSON, Form Data, x-www-form-urlencoded
р╣Гр╕Щр╕Чр╕╡р╣Ир╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Ир╕░р╣Гр╕Кр╣Й JSON р╣Ар╕Ыр╣Зр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Гр╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕Ыр╕вр╕▒р╕З Backend
р╣Бр╕Хр╣Ир╕Бр╣Ир╕нр╕Щр╕Чр╕╡р╣И Backend р╕Вр╕нр╕Зр╣Ар╕гр╕▓р╕Ир╕░р╕гр╕▒р╕Ъ Body р╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щ JSON р╣Др╕Фр╣Й р╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Ър╕нр╕Б Express р╕зр╣Ир╕▓р╣Гр╕лр╣Йр╣Гр╕Кр╣Й Body Parser р╣Гр╕Щр╕Бр╕▓р╕гр╣Бр╕Ыр╕ер╕З Body р╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╕Ир╕▓р╕Б Client(Frontend) р╣Ар╕Ыр╣Зр╕Щ JSON р╕Бр╣Ир╕нр╕Щ

р╣Гр╕Щ index.js р╣Гр╕лр╣Йр╣Ар╕Юр╕┤р╣Ир╕б
```javascript
// index.js
import express from "express";
import dotenv from "dotenv";
import { testConnection } from "./test.js";
import authRouter from "./routes/authRouter.js";

dotenv.config();
const app = express();
const PORT = process.env.PORT || 3000;

app.use(express.json()); // р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╣Гр╕Кр╣Й Body Parser
app.use("/api/v1/auth", authRouter);

app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
  testConnection();
});

```

р╣Бр╕ер╕░р╣Гр╕Щ authController.js р╣Гр╕лр╣Йр╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Body р╕Вр╕нр╕З Request
```javascript
// authController.js
export const registerUser = async (req, res) => {
  const { username, password } = req.body; // р╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Body
  res
    .status(200)
    .send({ message: "User registered successfully", username, password });
};
export const loginUser = async (req, res) => {
  const { username, password } = req.body; // р╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Body
  res
    .status(200)
    .send({ message: "User logged in successfully", username, password });
};

```

р╣Бр╕ер╣Йр╕зр╣Гр╕Щ Postman р╣Гр╕лр╣Йр╣Ар╕ер╕╖р╕нр╕Б Body р╣Бр╕ер╕░р╣Ар╕ер╕╖р╕нр╕Б raw р╣Бр╕ер╕░р╣Ар╕ер╕╖р╕нр╕Б JSON р╣Бр╕ер╣Йр╕зр╣Гр╕кр╣Ир╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕▓р╕бр╕Щр╕╡р╣Й
```
{
    "username": "testuser",
    "password": "testpassword"
}
```
р╣Бр╕ер╣Йр╕зр╕Бр╕Ф Send

![[20250402-1242-22.4709951.mp4]]

р╕Цр╣Йр╕▓р╣Ар╕гр╕▓р╕Чр╕│р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕Ир╕░р╣Др╕Фр╣Й Response р╕Бр╕ер╕▒р╕Ър╕бр╕▓р╕зр╣Ир╕▓
```json
{
  "message":"User registered successfully",
  "username":"testuser",
  "password":"testpassword"
}
```

#### 7.2.6 р╕Чр╕│ Logic р╕Бр╕▓р╕гр╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ (Register)

р╣Гр╕Щ authController.js р╣Гр╕лр╣Йр╕Чр╕│ Logic р╕Бр╕▓р╕гр╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ (Register) р╣Бр╕ер╕░р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ (Login) р╣Бр╕Хр╣Ир╕Бр╕▓р╕гр╣Ар╕Бр╣Зр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е User р╕Щр╕▒р╣Йр╕Щр╕Ир╕░р╕бр╕╡р╕Ыр╕гр╕░р╣Ар╕Фр╣Зр╕Щр╕Щр╕┤р╕Фр╕лр╕Щр╣Ир╕нр╕вр╕Щр╕▒р╣Ир╕Щр╕Др╕╖р╕н
- р╣Ар╕гр╕▓р╣Др╕бр╣Ир╕Др╕зр╕гр╣Ар╕Бр╣Зр╕Ъ Password р╕Вр╕нр╕З User р╣Др╕зр╣Йр╣Гр╕Щ Database р╣Бр╕Ър╕Ър╣Вр╕Фр╕вр╣Др╕бр╣Ир╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕к

р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Ар╕гр╕▓р╕Ир╕░р╕Чр╕│р╕вр╕▒р╕Зр╣Др╕Зр╕Фр╕╡
р╕Др╕│р╕Хр╕нр╕Ър╕Бр╣Зр╕Др╕╖р╕н р╕бр╕╡ Package(Library) р╕Чр╕╡р╣Ир╕Кр╕╖р╣Ир╕нр╕зр╣Ир╕▓ bcrypt р╣Ар╕Ыр╣Зр╕Щ Package р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕кр╕Хр╣Ир╕▓р╕Зр╣Ж (Encrypt) р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╣Йр╣Гр╕Кр╣Йр╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕вр╣Жр╕Ьр╣Ир╕▓р╕Щ Fucntion р╕Чр╕╡р╣И Package р╕Щр╕╡р╣Йр╣Гр╕лр╣Йр╕бр╕▓

р╣Ар╕Бр╕гр╣Зр╕Фр╕Др╕зр╕▓р╕бр╕гр╕╣р╣Й
hash function р╕Щр╕▒р╣Йр╕Щр╕бр╕╡р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕кр╕Чр╕╡р╣Ир╣Бр╕Щр╣Ир╕Щр╕нр╕Щ р╕Лр╕╢р╣Ир╕Зр╕лр╕бр╕▓р╕вр╕Др╕зр╕▓р╕бр╕зр╣Ир╕▓
- р╕Цр╣Йр╕▓ Input р╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Ар╕Фр╕┤р╕б Hash output р╕Бр╣Зр╕Ир╕░р╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Ар╕Фр╕┤р╕б

р╕кр╕бр╕бр╕╕р╕Хр╕┤р╕зр╣Ир╕▓р╕бр╕╡ User 2 р╕Др╕Щр╕Чр╕╡р╣Ир╕Хр╕▒р╣Йр╕З Password р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Щр╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕Вр╕нр╕Зр╣Ар╕гр╕▓р╕Бр╣Зр╕Ир╕░р╕бр╕╡ Password р╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Щр╣Гр╕Щ Database р╕Лр╕╢р╣Ир╕Зр╣Ар╕Ыр╣Зр╕Щр╣Ар╕гр╕╖р╣Ир╕нр╕Зр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Фр╕╡ р╣Ар╕Юр╕гр╕▓р╕░р╕Цр╣Йр╕▓р╕лр╕▓р╕Бр╕бр╕╡р╕Др╕Щр╣Бр╕ор╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щ Database р╕Вр╕нр╕Зр╣Ар╕гр╕▓р╣Др╕Фр╣Й р╣Ар╕Вр╕▓р╕Бр╣Зр╕Ир╕░р╕гр╕╣р╣Й Password р╕Вр╕нр╕З User р╕Чр╕╕р╕Бр╕Др╕Щр╕Чр╕╡р╣Ир╣Гр╕Кр╣Й Password р╣Ар╕Фр╕╡р╕вр╕зр╕Бр╕▒р╕Щ

р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╕Ир╕╢р╕Зр╕бр╕╡р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Ар╕гр╕╡р╕вр╕Бр╕зр╣Ир╕▓ Salt
Salt р╕Др╕╖р╕нр╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Лр╣Йр╕│р╕Бр╕▒р╕Щр╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╣Гр╕Щ Passwordр╣Ар╕Фр╕┤р╕б р╕Бр╣Ир╕нр╕Щр╕Чр╕╡р╣Ир╕Ир╕░р╕Чр╕│р╕Бр╕▓р╕г Hash
р╕бр╕▒р╕Щр╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕кр╣Ир╕б string р╕Вр╕╢р╣Йр╕Щр╕бр╕▓р╕Хр╕▒р╕зр╕Щр╕╢р╕З р╕Хр╣Ир╕нр╕Чр╣Йр╕▓р╕вр╕Бр╕▒р╕Ъ Password р╣Бр╕ер╣Йр╕зр╕Др╣Ир╕нр╕вр╣Ар╕нр╕▓р╕нр╕▒р╕Щр╕Чр╕╡р╣Ир╕Хр╣Ир╕нр╣Бр╕ер╣Йр╕зр╣Др╕Ы Hash
р╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Ир╕▓р╕Б Salt р╕Щр╕▒р╣Йр╕Щр╕Ир╕░р╕Цр╕╣р╕Бр╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щр╕бр╕▓р╣Бр╕Ър╕Ър╕кр╕╕р╣Ир╕бр╣Гр╕Щр╣Бр╕Хр╣Ир╕ер╕░р╕Др╕гр╕▒р╣Йр╕Зр╕Чр╕╡р╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ User р╣Гр╕лр╕бр╣И
р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╕Цр╣Йр╕▓р╕кр╕бр╕бр╕╕р╕Хр╕┤р╕зр╣Ир╕▓ User 2 р╕Др╕Щр╣Гр╕Кр╣Й Password р╣Ар╕Фр╕╡р╕вр╕зр╕Бр╕▒р╕Щ р╣Бр╕Хр╣И Salt р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕г Hash р╣Бр╕Хр╕Бр╕Хр╣Ир╕▓р╕Зр╕Бр╕▒р╕Щ
Password р╕Чр╕╡р╣Ир╣Др╕Фр╣Йр╕Ир╕▓р╕Бр╕Бр╕▓р╕г Hash р╕Бр╣Зр╕Ир╕░р╣Др╕бр╣Ир╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Щ

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З
```javascript
const bcrypt = require("bcrypt");

const password1 = "test";
const password2 = "test";

// bcrypt.hashSync р╕Др╕╖р╕нр╕Бр╕▓р╕г Hash Password
const hashedPassword1 = bcrypt.hashSync(password1, 10); // 10 р╕Др╕╖р╕нр╕Бр╕▓р╕гр╣Гр╕кр╣И Salt
const hashedPassword2 = bcrypt.hashSync(password2, 10); // 10 р╕Др╕╖р╕нр╕Бр╕▓р╕гр╣Гр╕кр╣И Salt

console.log("Hashed Password 1:", hashedPassword1);
console.log("Hashed Password 2:", hashedPassword2);
```

Output
```
Hashed Password 1: $2b$10$F4ZNSJRu7HWsqc7GenrerOx1NbsMTzh36l6nhZUDjBOyJpoVfu/im
Hashed Password 2: $2b$10$a2nwTbO1is7pg5ZOOoZplu7dRbBn43ArHwIg1F.s4Wf9L4zhL1606
```

р╕Ир╕░р╣Ар╕лр╣Зр╕Щр╕зр╣Ир╕▓ Hashed Password 1 р╣Бр╕ер╕░ Hashed Password 2 р╕Щр╕▒р╣Йр╕Щр╣Др╕бр╣Ир╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Щ
р╣Бр╕бр╣Йр╕зр╣Ир╕▓р╕Ир╕░р╣Гр╕Кр╣Й Password р╣Ар╕Фр╕╡р╕вр╕зр╕Бр╕▒р╕Щр╕Бр╣Зр╕Хр╕▓р╕б
р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╕Бр╕▓р╕гр╣Гр╕Кр╣Й Salt р╕Ир╕░р╕Чр╕│р╣Гр╕лр╣Й Password р╕Чр╕╡р╣Ир╣Ар╕Бр╣Зр╕Ър╣Гр╕Щ Database р╕Щр╕▒р╣Йр╕Щр╣Др╕бр╣Ир╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Щ р╣Бр╕бр╣Йр╕зр╣Ир╕▓р╕Ир╕░р╕бр╕╡ User 2 р╕Др╕Щр╕Чр╕╡р╣Ир╣Гр╕Кр╣Й Password р╣Ар╕Фр╕╡р╕вр╕зр╕Бр╕▒р╕Щр╕Бр╣Зр╕Хр╕▓р╕б



р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Ар╕гр╕▓р╕Ир╕░р╣Гр╕Кр╣Й Package р╕Щр╕╡р╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕к Password р╕Вр╕нр╕З User р╕Бр╣Ир╕нр╕Щр╕Чр╕╡р╣Ир╕Ир╕░р╣Ар╕Бр╣Зр╕Ър╕ер╕З Database
р╣Ар╕гр╕▓р╕Ир╕░р╣Гр╕Кр╣Й bcrypt р╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕к Password р╕Вр╕нр╕З User р╣Вр╕Фр╕вр╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Package р╕Щр╕╡р╣Йр╕Бр╣Ир╕нр╕Щ

```bash
npm install bcrypt
```
р╣Бр╕ер╣Йр╕зр╣Гр╕Щ authController.js р╣Гр╕лр╣Йр╕Чр╕│р╕Бр╕▓р╕г import bcrypt р╣Ар╕Вр╣Йр╕▓р╕бр╕▓
```javascript
// authController.js
import bcrypt from "bcrypt";
import { query } from "../config/database.js";

export async function registerUser(req, res) {
  try {
    const { username, email, password } = req.body; // р╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Body

    // р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓р╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    if (!username || !email || !password) {
      return res.status(400).json({
        error: "Please provide username, email, and password.",
      });
    }

    // р╣Гр╕кр╣И role р╣Др╕зр╣Йр╕Бр╣Ир╕нр╕Щ
    const role = "user";

    // р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓р╕бр╕╡ email р╕Щр╕╡р╣Йр╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕лр╕гр╕╖р╕нр╣Др╕бр╣И р╕Цр╣Йр╕▓р╕бр╕╡р╣Гр╕лр╣Й return error
    const existing = await query("SELECT * FROM users WHERE email = $1", [
      email,
    ]);
    if (existing.rowCount > 0) {
      return res.status(400).json({
        error: "User with this email already exists.",
      });
    }

    // р╕кр╕гр╣Йр╕▓р╕З user_id р╣Гр╕лр╕бр╣И
    const idRes = await query("SELECT generate_user_id() as id");
    const user_id = idRes.rows[0].id;

    // р╣Гр╕Кр╣Й bcrypt р╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕к Password р╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Ъ Salt
    const hashedPassword = await bcrypt.hash(password, 10);

    // р╕кр╕гр╣Йр╕▓р╕З User р╣Гр╕лр╕бр╣Ир╣Гр╕Щ р╕Хр╕▓р╕гр╕▓р╕З users
    await query(
      `INSERT INTO users (user_id, username, email, password, role)
       VALUES ($1, $2, $3, $4, $5)`,
      [user_id, username, email, hashedPassword, role]
    );

    // р╕кр╣Ир╕З Response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓ User р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╕кр╕│р╣Ар╕гр╣Зр╕И
    res.status(201).json({
      success: true,
      message: "Registration successful",
      userId: user_id,
    });
  } catch (error) {
    // р╕Цр╣Йр╕▓р╕бр╕╡ Error р╣Гр╕лр╣Йр╕кр╣Ир╕З Response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓ Internal server error
    res.status(500).json({ error: "Internal server error" });
  }
} catch (error) {
  // Handle any unexpected errors
  console.error(error);
  res.status(500).json({ error: "Internal server error" });
}

export const loginUser = async (req, res) => {
  const { username, password } = req.body; // р╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Body
  res
    .status(200)
    .send({ message: "User logged in successfully", username, password });
};

```
#### 7.2.7 р╕Чр╕│ Logic р╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ (Login)

р╣Вр╕нр╣Ар╕Д! р╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Ир╕░р╕Чр╕│ Logic р╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ (Login) р╣Вр╕Фр╕вр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ User р╕бр╕╡р╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕лр╕гр╕╖р╕нр╣Др╕бр╣И
р╣Бр╕Хр╣Ир╕Бр╕▓р╕г Login р╕Бр╣Зр╕бр╕╡р╕Ыр╕гр╕░р╣Ар╕Фр╣Зр╕Щр╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Щ
р╕Щр╕▒р╣Ир╕Щр╕Др╕╖р╕н р╣Ар╕гр╕▓р╣Ар╕Ыр╣Зр╕Щ Backend р╣Ар╕гр╕▓р╣Др╕бр╣Ир╕гр╕╣р╣Йр╕зр╣Ир╕▓ frontend р╕Вр╕нр╕Зр╣Ар╕гр╕▓р╕Щр╕▒р╣Йр╕Щр╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕лр╕гр╕╖р╕нр╕вр╕▒р╕З

ЁЯУМ р╕кр╕бр╕бр╕╕р╕Хр╕┤р╕зр╣Ир╕▓ User р╕Др╕Щр╕лр╕Щр╕╢р╣Ир╕З Login р╣Ар╕Вр╣Йр╕▓р╕бр╕▓р╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕Ьр╣Ир╕▓р╕Щр╕лр╕Щр╣Йр╕▓р╣Ар╕зр╣Зр╕Ър╕кр╕│р╣Ар╕гр╣Зр╕И р╣Бр╕ер╣Йр╕зр╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕Щр╕▒р╣Йр╕Щр╣Ар╕Вр╕▓р╕Бр╣Зр╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╕вр╕▒р╕Зр╕лр╕Щр╣Йр╕▓ Dashboard
**р╕Др╕│р╕Цр╕▓р╕бр╕Др╕╖р╕н** р╣Ар╕гр╕▓р╕Ир╕░р╕гр╕╣р╣Йр╣Др╕Фр╣Йр╕вр╕▒р╕Зр╣Др╕Зр╕зр╣Ир╕▓ User р╕Др╕Щр╕Щр╕╡р╣Й Login р╣Бр╕ер╣Йр╕зр╕Ир╕гр╕┤р╕З р╣Ж?

тЬЕ р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣Ир╕Щр╕┤р╕вр╕бр╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╕Ыр╕▒р╕Нр╕лр╕▓р╕Щр╕╡р╣Йр╣Гр╕Щр╕гр╕░р╕Ър╕Ъ Web р╕Чр╕▒р╣Ир╕зр╣Др╕Ыр╕Бр╣Зр╕Др╕╖р╕н **р╕Бр╕▓р╕гр╕кр╣Ир╕З Token (р╣Вр╕Чр╣Ар╕Др╕Щ)** р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╣Гр╕лр╣Йр╕Эр╕▒р╣Ир╕З Frontend р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕Чр╕╡р╣И Login р╕кр╕│р╣Ар╕гр╣Зр╕И

---

##### ЁЯФС Token р╕Др╕╖р╕нр╕нр╕░р╣Др╕г?

- Token р╕Др╕╖р╕н тАЬр╕лр╕ер╕▒р╕Бр╕Рр╕▓р╕Щр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕ЩтАЭ р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Ир╕░р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щр╕бр╕▓ р╣Бр╕ер╕░р╕кр╣Ир╕Зр╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╣Гр╕лр╣Й Client (Frontend)
- р╣Вр╕Фр╕вр╕Чр╕▒р╣Ир╕зр╣Др╕Ы Token р╕Ир╕░р╣Ар╕Бр╣Зр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Вр╕нр╕З User р╕Чр╕╡р╣И Login р╣Ар╕Вр╣Йр╕▓р╕бр╕▓
- р╣Бр╕ер╣Йр╕з Frontend р╕Бр╣Зр╕Ир╕░р╕Хр╣Йр╕нр╕Зр╣Бр╕Щр╕Ъ Token р╕Щр╕╡р╣Йр╕бр╕▓р╕Фр╣Йр╕зр╕вр╕Чр╕╕р╕Бр╕Др╕гр╕▒р╣Йр╕Зр╕Чр╕╡р╣Ир╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ API р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕бр╕╡р╕Бр╕▓р╕гр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щ

---

##### ЁЯФР р╣Бр╕ер╣Йр╕зр╣Ар╕гр╕▓р╕Ир╕░р╕кр╕гр╣Йр╕▓р╕З Token р╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г?

ЁЯТб р╕Др╕│р╕Хр╕нр╕Ър╕Др╕╖р╕н р╣Ар╕гр╕▓р╕Ир╕░р╣Гр╕Кр╣Й **JWT (JSON Web Token)**

---

##### JWT р╕Др╕╖р╕нр╕нр╕░р╣Др╕г?

JWT (JSON Web Token) р╕Др╕╖р╕н р╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕кр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╣Йр╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Вр╕нр╕З Token р╕Чр╕╡р╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Йр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕гр╕░р╕Ър╕Ър╣Бр╕Ър╕Ър╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в
р╕Лр╕╢р╣Ир╕Зр╣Гр╕Щ JWT р╕Ир╕░р╕бр╕╡р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф 3 р╕кр╣Ир╕зр╕Щр╕лр╕ер╕▒р╕Б р╣Ж р╕Др╕╖р╕н:

1. **Header** тАУ р╕Ър╕нр╕Бр╕зр╣Ир╕▓р╣Гр╕Кр╣Йр╕зр╕┤р╕Шр╕╡р╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕кр╣Бр╕Ър╕Ър╣Др╕лр╕Щ р╣Ар╕Кр╣Ир╕Щ HS256
2. **Payload** тАУ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕нр╕вр╕▓р╕Бр╕Эр╕▒р╕Зр╣Др╕зр╣Йр╣Гр╕Щ Token р╣Ар╕Кр╣Ир╕Щ user_id, email, role р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕Щ
3. **Signature** тАУ р╕ер╕▓р╕вр╣Ар╕Лр╣Зр╕Щр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕зр╣Ир╕▓ Token р╕Щр╕╡р╣Йр╕Цр╕╣р╕Бр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Фр╕вр╣Ар╕гр╕▓ (Server)

ЁЯза р╣Ар╕бр╕╖р╣Ир╕н User Login р╕кр╕│р╣Ар╕гр╣Зр╕И р╣Ар╕гр╕▓р╕Ир╕░р╕кр╕гр╣Йр╕▓р╕З JWT Token р╣Гр╕лр╣Й р╣Бр╕ер╕░р╣Бр╕Щр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕ер╕Зр╣Др╕Ыр╣Гр╕Щ Payload
р╕Ир╕▓р╕Бр╕Щр╕▒р╣Йр╕Щр╕кр╣Ир╕З Token р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╣Гр╕лр╣Йр╕Эр╕▒р╣Ир╕З Frontend р╣Ар╕Бр╣Зр╕Ър╣Др╕зр╣Й р╣Ар╕Кр╣Ир╕Щр╣Гр╕Щ LocalStorage р╕лр╕гр╕╖р╕н Cookie

р╣Бр╕ер╕░р╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Б API р╕Цр╕▒р╕Ф р╣Ж р╣Др╕Ы р╕Эр╕▒р╣Ир╕З Frontend р╕Бр╣Зр╕Ир╕░р╣Бр╕Щр╕Ъ JWT Token р╕Щр╕╡р╣Йр╕бр╕▓р╣Гр╕Щ Header р╕Вр╕нр╕З HTTP Request
р╣Ар╕Кр╣Ир╕Щ:
```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╕Хр╣Ир╕нр╕Бр╕▒р╕Щр╣Ар╕ер╕вр╕вр╕в
р╣Ар╕гр╕▓р╕Ир╕░р╣Гр╕Кр╣Й Package р╕Чр╕╡р╣Ир╕Кр╕╖р╣Ир╕нр╕зр╣Ир╕▓ jsonwebtoken р╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З Token р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щр╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
р╣Вр╕Фр╕вр╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Package р╕Щр╕╡р╣Йр╕Бр╣Ир╕нр╕Щ
```bash
npm install jsonwebtoken
```

р╣Бр╕ер╣Йр╕зр╣Гр╕Щ authController.js р╣Гр╕лр╣Йр╕Чр╕│р╕Бр╕▓р╕г import jsonwebtoken р╣Ар╕Вр╣Йр╕▓р╕бр╕▓
```javascript
// authController.js
import bcrypt from "bcrypt";
import { query } from "../config/database.js";
import jwt from "jsonwebtoken";

export async function registerUser(req, res) {
  try {
    const { username, email, password } = req.body; // р╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Body

    // р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓р╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    if (!username || !email || !password) {
      return res.status(400).json({
        error: "Please provide username, email, and password.",
      });
    }

    // р╣Гр╕кр╣И role р╣Др╕зр╣Йр╕Бр╣Ир╕нр╕Щ
    const role = "user";

    // р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓р╕бр╕╡ email р╕Щр╕╡р╣Йр╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕лр╕гр╕╖р╕нр╣Др╕бр╣И р╕Цр╣Йр╕▓р╕бр╕╡р╣Гр╕лр╣Й return error
    const existing = await query("SELECT * FROM users WHERE email = $1", [
      email,
    ]);
    if (existing.rowCount > 0) {
      return res.status(400).json({
        error: "User with this email already exists.",
      });
    }

    // р╕кр╕гр╣Йр╕▓р╕З user_id р╣Гр╕лр╕бр╣И
    const idRes = await query("SELECT generate_user_id() as id");
    const user_id = idRes.rows[0].id;

    // р╣Гр╕Кр╣Й bcrypt р╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕к Password р╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Ъ Salt
    const hashedPassword = await bcrypt.hash(password, 10);

    // р╕кр╕гр╣Йр╕▓р╕З User р╣Гр╕лр╕бр╣Ир╣Гр╕Щ р╕Хр╕▓р╕гр╕▓р╕З users
    await query(
      `INSERT INTO users (user_id, username, email, password, role)
       VALUES ($1, $2, $3, $4, $5)`,
      [user_id, username, email, hashedPassword, role]
    );

    // р╕кр╣Ир╕З Response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓ User р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╕кр╕│р╣Ар╕гр╣Зр╕И
    res.status(201).json({
      success: true,
      message: "Registration successful",
      userId: user_id,
    });
  } catch (error) {
    // Handle any unexpected errors
    console.error(error);
    res.status(500).json({ error: "Internal server error" });
  }
}

export async function loginUser(req, res) {
  try {
    const { email, password } = req.body; // р╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Body

    // р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓р╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    if (!email || !password) {
      return res.status(400).json({
        error: "Please provide email and password.",
      });
    }

    // р╕лр╕▓ User р╣Гр╕Щ Database
    const userRes = await query("SELECT * FROM users WHERE email = $1", [
      email,
    ]);
    if (userRes.rowCount === 0) {
      return res.status(401).json({ error: "Invalid credentials" });
    }

    const user = userRes.rows[0];

    // р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Password р╕Бр╕▒р╕Ъ Hashed Password р╕Чр╕╡р╣Ир╣Ар╕Бр╣Зр╕Ър╣Гр╕Щ Database
    const passwordMatch = await bcrypt.compare(password, user.password);
    if (!passwordMatch) {
      return res.status(401).json({ error: "Invalid credentials" });
    }

    // р╕кр╕гр╣Йр╕▓р╕З JWT Token р╣Вр╕Фр╕вр╣Гр╕Кр╣Й fucntion generateToken р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щ
    const token = generateToken(user);

    console.info(`User ${user.user_id} logged in successfully`);

    // р╕кр╣Ир╕З Response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓ User Login р╕кр╕│р╣Ар╕гр╣Зр╕И
    res.status(200).json({
      success: true,
      token,
      userId: user.user_id,
      name: user.username || user.email.split("@")[0],
      email: user.email,
    });
  } catch (error) {
    // р╕Цр╣Йр╕▓р╕бр╕╡ Error р╣Гр╕лр╣Йр╕кр╣Ир╕З Response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓ Internal server error
    console.error("Login error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

function generateToken(user) {
  // р╕кр╕гр╣Йр╕▓р╕З JWT Token р╣Вр╕Фр╕вр╣Гр╕Кр╣Й jsonwebtoken jwt.sign р╕Др╕╖р╕н р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З Token р╣Вр╕Фр╕вр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Ир╕░р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Ар╕Бр╣Зр╕Ър╣Гр╕Щ Token р╣Др╕Ы
  return jwt.sign(
    {
      userId: user.user_id,
      email: user.email,
      role: user.role,
    },
    process.env.JWT_SECRET, // Secret Key р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕к Token
    { expiresIn: "15d" }
  );
}

```

^84a15c

р╕Бр╣Ир╕нр╕Щр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ JWT Token р╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕кр╕гр╣Йр╕▓р╕З Secret Key р╕Вр╕╢р╣Йр╕Щр╕бр╕▓р╕Бр╣Ир╕нр╕Щ
р╕Лр╕╢р╣Ир╕З Secret Key р╕Щр╕╡р╣Йр╕Ир╕░р╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕к Token р╣Бр╕ер╕░р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕Вр╕нр╕З Token
р╣Вр╕Фр╕в Secret Key р╕Щр╕╡р╣Йр╕Ир╕░р╕Хр╣Йр╕нр╕Зр╣Ар╕Бр╣Зр╕Ър╣Ар╕Ыр╣Зр╕Щр╕Др╕зр╕▓р╕бр╕ер╕▒р╕Ъ р╣Др╕бр╣Ир╕Др╕зр╕гр╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ьр╕вр╣Гр╕лр╣Йр╣Гр╕Др╕гр╕гр╕╣р╣Й
р╣Гр╕Щр╕Чр╕╡р╣Ир╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Ир╕░р╣Гр╕кр╣И String р╕нр╕░р╣Др╕гр╕Бр╣Зр╣Др╕Фр╣Йр╕ер╕Зр╣Др╕Ыр╕Бр╣Ир╕нр╕Щ
р╣Др╕Ыр╕Чр╕╡р╣Ир╣Др╕Яр╕ер╣М .env р╣Бр╕ер╣Йр╕зр╣Ар╕Юр╕┤р╣Ир╕бр╕Ър╕гр╕гр╕Чр╕▒р╕Фр╕Щр╕╡р╣Йр╣Ар╕Вр╣Йр╕▓р╣Др╕Ы

р╣Гр╕Щр╣Др╕Яр╕ер╣М .env
```bash
PORT=3000
DATABASE_URL=postgres://admin:password@localhost:5432/taskmanagement
JWT_SECRET=your_jwt_secret
```

р╣Бр╕ер╣Йр╕зр╕ер╕нр╕Зр╕Чр╕Фр╕кр╕нр╕Ъ Login р╣Гр╕лр╕бр╣Ир╣Гр╕Щ Postman р╣Вр╕Фр╕вр╕Бр╕▓р╕гр╕кр╣Ир╕З POST Request р╣Др╕Ыр╕Чр╕╡р╣И
```
http://localhost:3000/api/v1/auth/login
```
р╣Бр╕ер╕░ Body
```
{
    "email" : "test@gmail.com",
    "password" : "testpassword"
}
```

р╣Бр╕ер╣Йр╕зр╕Бр╕Ф Send

![[20250402-1930-54.5167538.mp4]]

р╕Цр╣Йр╕▓р╕Чр╕│р╣Др╕Фр╣Йр╕кр╕│р╣Ар╕гр╣Зр╕Ир╕Ир╕░р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╣Ар╕Ыр╣Зр╕Щр╣Бр╕Ър╕Ър╕Фр╣Йр╕▓р╕Щр╕ер╣Ир╕▓р╕З р╣Бр╕ер╕░р╣Ар╕гр╕▓р╕Ир╕░р╣Др╕Фр╣Й Token р╕бр╕▓р╕Фр╣Йр╕зр╕в
``` json
{
    "success": true,
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9....",
    "userId": "00001",
    "name": "testuser",
    "email": "test@gmail.com"
}
```

р╣Гр╕Щ Token р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щр╕бр╕▓р╕Щр╕▒р╣Йр╕Щр╕Ир╕░р╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣И Backend р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╣Гр╕лр╣Й Frontend р╕Эр╕▒р╣Ир╕Зр╣Ар╕Бр╣Зр╕Ър╣Др╕зр╣Й р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕Эр╕▒р╕Зр╣Др╕зр╣Йр╕Ир╕░р╣Ар╕Ыр╣Зр╕Щр╕Хр╕▓р╕б Function [[Start Point#^84a15c | generateToken р╕Вр╕нр╕Зр╣Ар╕гр╕▓]]
р╕Лр╕╢р╣Ир╕Зр╣Ар╕гр╕▓р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕ер╕нр╕Зр╕Щр╕│ Token р╕бр╕▓р╕Цр╕нр╕Фр╕гр╕лр╕▒р╕кр╣Др╕Фр╣Йр╕Чр╕╡р╣И https://jwt.is/

![[20250403-0534-27.1798150.mp4]]

![[Pasted image 20250403123553.png]]

р╕Ир╕▓р╕Бр╣Гр╕Щр╕гр╕╣р╕Ыр╕Ир╕░р╣Ар╕лр╣Зр╕Щр╕зр╣Ир╕▓ Token р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щр╕бр╕▓ р╣Ар╕бр╕╖р╣Ир╕нр╕Цр╕нр╕Фр╕гр╕лр╕▒р╕кр╕Щр╕▒р╣Йр╕Щр╕Ир╕░р╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Эр╕▒р╕Зр╣Др╕зр╣Й
р╣Бр╕ер╕░ Token р╕Щр╕╡р╣Й Frontend р╕Ир╕░р╕Хр╣Йр╕нр╕Зр╣Бр╕Щр╕Ър╣Др╕Ыр╕Бр╕▒р╕Ър╕Чр╕╕р╕Б Request р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щ
р╣Бр╕ер╣Йр╕з Backend р╕Ир╕░р╕Чр╕нр╕Фр╕нр╕нр╕Бр╕бр╕▓р╕Фр╕╣р╕зр╣Ир╕▓ Token р╕Щр╕╡р╣Йр╣Ар╕Ыр╣Зр╕Щр╕Вр╕нр╕Зр╣Гр╕Др╕гр╣Ар╕Юр╕╖р╣Ир╕нр╕Чр╕╡р╣Ир╕Ир╕░р╣Гр╕Кр╣Йр╣Гр╕Щ Operation р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Бр╕▓р╕гр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щ

р╣Вр╕нр╣Ар╕Д! р╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Чр╕│р╕Бр╕▓р╕гр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щр╕Вр╕нр╕З User р╣Др╕Фр╣Йр╣Бр╕ер╣Йр╕з
р╕Хр╣Ир╕нр╣Др╕Ыр╣Ар╕гр╕▓р╕Ир╕░р╕Чр╕│р╣Гр╕лр╣Й Backend р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е User р╕Чр╕╡р╣И Login р╣Ар╕Вр╣Йр╕▓р╕бр╕▓р╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕Ир╕▓р╕Б Token р╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╕Ьр╣Ир╕▓р╕Щ Middleware р╕Бр╕▒р╕Щ!

### 7.3 р╕кр╕гр╣Йр╕▓р╕З Middleware
Middleware р╕Др╕╖р╕н р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Чр╕╡р╣Ир╕Чр╕│р╕Зр╕▓р╕Щр╕гр╕░р╕лр╕зр╣Ир╕▓р╕З Request р╣Бр╕ер╕░ Response
Middleware р╕Ир╕░р╕Чр╕│р╕Зр╕▓р╕Щр╕Бр╣Ир╕нр╕Щр╕Чр╕╡р╣И Request р╕Ир╕░р╕Цр╕╣р╕Бр╕кр╣Ир╕Зр╣Др╕Ыр╕вр╕▒р╕З Route Handler
Middleware р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Token р╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╕Ир╕▓р╕Б Client (Frontend) р╕зр╣Ир╕▓р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
р╣Бр╕ер╕░р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е User р╕Ир╕▓р╕Б Token р╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╕Фр╣Йр╕зр╕в

р╣Ар╕гр╕▓р╕Ир╕░р╕бр╕▓р╕ер╕нр╕Зр╕Фр╕╣р╕ар╕▓р╕Юр╕гр╕зр╕бр╕Бр╕▒р╕Щр╕зр╣Ир╕▓р╣Ар╕Ыр╣Зр╕Щр╕вр╕▒р╕Зр╣Др╕З

![[Pasted image 20250403141514.png]]
р╣Ар╕гр╕┤р╣Ир╕бр╕Ир╕▓р╕Бр╕бр╕╡ HTTP reqeust р╣Ар╕Вр╣Йр╕▓р╕бр╕▓р╕Чр╕╡р╣И Backend р╕Вр╕нр╕Зр╣Ар╕гр╕▓р╣Вр╕Фр╕вр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Др╕Ыр╕вр╕▒р╕З API р╕Чр╕╡р╣Ир╕Хр╕▒р╕з Router р╕Бр╣Зр╕Ир╕░р╕бр╕нр╕Зр╕Фр╕╣р╕зр╣Ир╕▓ р╣Ар╕кр╣Йр╕Щр╕Чр╕▓р╕Зр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Др╕Ыр╕Щр╕▒р╣Йр╕Щр╣Др╕Фр╣Йр╕бр╕╡р╕Бр╕▓р╕гр╕Бр╕│р╕лр╕Щр╕Ф Middleware р╣Др╕зр╣Йр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
р╕Цр╣Йр╕▓р╕бр╕╡р╕Бр╣Зр╕Ир╕░р╕кр╣Ир╕Зр╕Хр╣Ир╕нр╣Др╕Ыр╣Гр╕лр╣Й Middleware р╕Чр╕│р╕Зр╕▓р╕Щр╕Бр╣Ир╕нр╕Щ

![[Pasted image 20250403142108.png]]
р╣Ар╕бр╕╖р╣Ир╕нр╣Др╕Ыр╕Цр╕╢р╕З Middleware, Middleware р╕Ир╕░р╕Чр╕│р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Token р╕Чр╕╡р╣Ир╣Бр╕Щр╕Ър╕бр╕▓р╕Бр╕▒р╕Ъ Request р╕зр╣Ир╕▓р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Ър╕Цр╕нр╕Фр╕гр╕лр╕▒р╕кр╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е User р╕нр╕нр╕Бр╕бр╕▓р╣Бр╕ер╣Йр╕зр╣Бр╕Щр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е User р╕Бр╕ер╕▒р╕Ър╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╣Гр╕Щ Request

![[Pasted image 20250403142504.png]]
р╣Бр╕ер╣Йр╕з Middleware р╕Ир╕░р╕кр╣Ир╕Зр╕Хр╣Ир╕н Request р╕Чр╕╡р╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕е User р╣Др╕Ыр╕вр╕▒р╕З Route Handler


![[Pasted image 20250403142926.png]]
р╣Бр╕ер╣Йр╕зр╕Чр╕╡р╣И route handler р╕Бр╣Зр╕Ир╕░р╕бр╕нр╕Зр╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Бр╕Щр╕Ър╕бр╕▓р╕Фр╣Йр╕зр╕вр╣Гр╕Щ Request Header р╕Чр╕╡р╣Ир╕Ьр╣Ир╕▓р╕Щр╕Ир╕▓р╕Б Middleware р╕бр╕▓р╣Бр╕ер╣Йр╕з

р╣Ар╕Чр╣Ир╕▓р╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Бр╣Зр╕Ир╕░р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕гр╕╣р╣Йр╣Др╕Фр╣Йр╣Бр╕ер╣Йр╕зр╕зр╣Ир╕▓ User р╕Чр╕╡р╣И Login р╣Ар╕Вр╣Йр╕▓р╕бр╕▓р╕Щр╕▒р╣Йр╕Щр╕Др╕╖р╕нр╣Гр╕Др╕г


#### 7.3.1 р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М Middleware
р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Ар╕гр╕┤р╣Ир╕бр╣Ар╕ер╕вр╣Вр╕Фр╕вр╣Ар╕гр╕▓р╕Ир╕░р╕кр╕гр╣Йр╕▓р╕З Folder р╣Гр╕лр╕бр╣Ир╕Кр╕╖р╣Ир╕нр╕зр╣Ир╕▓ middleware р╣Бр╕ер╕░р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М authMiddleware.js р╕Вр╕╢р╣Йр╕Щр╕бр╕▓

![[Pasted image 20250403144939.png]]

```javascript
import jwt from "jsonwebtoken";

export function authMiddleware(req, res, next) {
  try {
    // р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓ request р╕бр╕╡ header Authorization р╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    const authHeader = req.headers.authorization;
    let token = null;

    // р╕Фр╕╢р╕З token р╕Ир╕▓р╕Б header Authorization р╕Цр╣Йр╕▓р╕бр╕╡
    if (authHeader && authHeader.startsWith("Bearer ")) {
      token = authHeader.split(" ")[1];
    }
    // р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡ token р╣Гр╕Щ header Authorization р╣Гр╕лр╣Йр╕ер╕нр╕Зр╕Фр╕╢р╕Зр╕Ир╕▓р╕Б cookie
    else if (req.cookies && req.cookies.token) {
      token = req.cookies.token;
    }

    // р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡ token р╣Гр╕лр╣Йр╕кр╣Ир╕З response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓р╣Др╕бр╣Ир╕нр╕Щр╕╕р╕Нр╕▓р╕Хр╣Гр╕лр╣Йр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕З
    if (!token) {
      return res.status(401).json({ error: "Authentication required" });
    }

    // р╕Цр╣Йр╕▓р╕бр╕╡ token р╣Гр╕лр╣Йр╕Чр╕│р╕Бр╕▓р╕г verify token р╕Фр╣Йр╕зр╕в secret key
    try {
      // р╕нр╕▒р╕Щр╕Щр╕╡р╣Йр╕Др╕╖р╕нр╕Бр╕▓р╕гр╕Цр╕нр╕Фр╕гр╕лр╕▒р╕к token р╕нр╕нр╕Бр╕бр╕▓р╣Вр╕Фр╕вр╣Гр╕Кр╣Й secret key р╣Др╕зр╣Йр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ Token р╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╕Щр╕▒р╣Йр╕Щр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
      const decoded = jwt.verify(token, process.env.JWT_SECRET);
      req.user = decoded; // р╣Ар╕Бр╣Зр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Гр╕Щ request object р╕Бр╣Ир╕нр╕Щр╕кр╣Ир╕Зр╕Хр╣Ир╕нр╣Др╕Ыр╕вр╕▒р╕З route handler function
      next(); // р╕Цр╣Йр╕▓ token р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З р╣Гр╕лр╣Йр╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Й next() р╣Ар╕Юр╕╖р╣Ир╕нр╣Др╕Ыр╕вр╕▒р╕З route handler р╕Цр╕▒р╕Фр╣Др╕Ы
    } catch (jwtError) {
      console.error("JWT verification failed", jwtError);
      return res.status(401).json({ error: "Invalid or expired token" });
    }
  } catch (err) {
    console.error("Auth middleware error", err);
    return res.status(500).json({ error: "Authentication error" });
  }
}
```
#### 7.3.2 р╕ер╕нр╕Зр╕кр╕гр╣Йр╕▓р╕З Endpoint р╣Гр╕лр╕бр╣Ир╣Ар╕Юр╕╖р╣Ир╕нр╕ер╕нр╕Зр╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е User р╕Фр╕╣
р╣Гр╕Щр╣Др╕Яр╕ер╣М authRouter.js р╣Гр╕лр╣Йр╕ер╕нр╕Зр╕кр╕гр╣Йр╕▓р╕З Endpoint р╣Гр╕лр╕бр╣Ир╕Вр╕╢р╣Йр╕Щр╕бр╕▓
```javascript
// authRouter.js
import express from "express";
import { registerUser, loginUser,  getMe } from "../controllers/authController.js";
import { authMiddleware } from "../middleware/authMiddleware.js";

const router = express.Router();

router.post("/register", registerUser); // POST /api/v1/auth/register
router.post("/login", loginUser); // POST /api/v1/auth/login

// р╣Ар╕Ыр╣Зр╕Щр╕Бр╕▓р╕гр╕Ър╕нр╕Бр╕зр╣Ир╕▓р╣Гр╕лр╣Йр╣Гр╕Кр╣Й middleware р╕Бр╣Ир╕нр╕Щр╕Ир╕░р╕кр╣Ир╕Зр╣Др╕Ыр╕вр╕▒р╕З controller getMe р╕Щр╣Йр╕░р╕░
router.get("/me", authMiddleware, getMe); // GET /api/v1/auth/me

export default router;

```
р╣Бр╕ер╣Йр╕зр╣Гр╕Щ authController.js р╣Гр╕лр╣Йр╕ер╕нр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ getMe р╕Вр╕╢р╣Йр╕Щр╕бр╕▓
```javascript
// authController.js
import bcrypt from "bcrypt";
import { query } from "../config/database.js";
import jwt from "jsonwebtoken";

export async function registerUser(req, res) {
  try {
    const { username, email, password } = req.body; // р╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Body

    // р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓р╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    if (!username || !email || !password) {
      return res.status(400).json({
        error: "Please provide username, email, and password.",
      });
    }

    // р╣Гр╕кр╣И role р╣Др╕зр╣Йр╕Бр╣Ир╕нр╕Щ
    const role = "user";

    // р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓р╕бр╕╡ email р╕Щр╕╡р╣Йр╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕лр╕гр╕╖р╕нр╣Др╕бр╣И р╕Цр╣Йр╕▓р╕бр╕╡р╣Гр╕лр╣Й return error
    const existing = await query("SELECT * FROM users WHERE email = $1", [
      email,
    ]);
    if (existing.rowCount > 0) {
      return res.status(400).json({
        error: "User with this email already exists.",
      });
    }

    // р╕кр╕гр╣Йр╕▓р╕З user_id р╣Гр╕лр╕бр╣И
    const idRes = await query("SELECT generate_user_id() as id");
    const user_id = idRes.rows[0].id;

    // р╣Гр╕Кр╣Й bcrypt р╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕к Password р╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Ъ Salt
    const hashedPassword = await bcrypt.hash(password, 10);

    // р╕кр╕гр╣Йр╕▓р╕З User р╣Гр╕лр╕бр╣Ир╣Гр╕Щ р╕Хр╕▓р╕гр╕▓р╕З users
    await query(
      `INSERT INTO users (user_id, username, email, password, role)
       VALUES ($1, $2, $3, $4, $5)`,
      [user_id, username, email, hashedPassword, role]
    );

    // р╕кр╣Ир╕З Response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓ User р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╕кр╕│р╣Ар╕гр╣Зр╕И
    res.status(201).json({
      success: true,
      message: "Registration successful",
      userId: user_id,
    });
  } catch (error) {
    // Handle any unexpected errors
    console.error(error);
    res.status(500).json({ error: "Internal server error" });
  }
}
export async function loginUser(req, res) {
  try {
    const { email, password } = req.body; // р╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Body

    // р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓р╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    if (!email || !password) {
      return res.status(400).json({
        error: "Please provide email and password.",
      });
    }

    // р╕лр╕▓ User р╣Гр╕Щ Database
    const userRes = await query("SELECT * FROM users WHERE email = $1", [
      email,
    ]);
    if (userRes.rowCount === 0) {
      return res.status(401).json({ error: "Invalid credentials" });
    }

    const user = userRes.rows[0];

    // р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Password р╕Бр╕▒р╕Ъ Hashed Password р╕Чр╕╡р╣Ир╣Ар╕Бр╣Зр╕Ър╣Гр╕Щ Database
    const passwordMatch = await bcrypt.compare(password, user.password);
    if (!passwordMatch) {
      return res.status(401).json({ error: "Invalid credentials" });
    }

    // р╕кр╕гр╣Йр╕▓р╕З JWT Token р╣Вр╕Фр╕вр╣Гр╕Кр╣Й fucntion generateToken р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щ
    const token = generateToken(user);

    console.info(`User ${user.user_id} logged in successfully`);

    // р╕кр╣Ир╕З Response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓ User Login р╕кр╕│р╣Ар╕гр╣Зр╕И
    res.status(200).json({
      success: true,
      token,
      userId: user.user_id,
      name: user.username || user.email.split("@")[0],
      email: user.email,
    });
  } catch (error) {
    // р╕Цр╣Йр╕▓р╕бр╕╡ Error р╣Гр╕лр╣Йр╕кр╣Ир╕З Response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕зр╣Ир╕▓ Internal server error
    console.error("Login error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

export async function getMe(req, res) {
  try {
    const { userId } = req.user;
    const userRes = await query(
      "SELECT user_id, username, email, role FROM users WHERE user_id = $1",
      [userId]
    );
    if (userRes.rowCount === 0) {
      return res.status(404).json({ error: "User not found" });
    }

    const user = userRes.rows[0];

    res.status(200).json({
      userId: user.user_id,
      name: user.username,
      email: user.email,
      role: user.role,
    });
  } catch (error) {
    log.error("Get current user error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

function generateToken(user) {
  // р╕кр╕гр╣Йр╕▓р╕З JWT Token р╣Вр╕Фр╕вр╣Гр╕Кр╣Й jsonwebtoken jwt.sign р╕Др╕╖р╕н р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З Token р╣Вр╕Фр╕вр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Ир╕░р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Ар╕Бр╣Зр╕Ър╣Гр╕Щ Token р╣Др╕Ы
  return jwt.sign(
    {
      userId: user.user_id,
      email: user.email,
      role: user.role,
    },
    process.env.JWT_SECRET, // Secret Key р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕к Token
    { expiresIn: "15d" }
  );
}
```

#### 7.3.3 р╕Чр╕Фр╕кр╕нр╕Ър╣Вр╕Фр╕в Postman
р╕ер╕нр╕Зр╕Чр╕Фр╕кр╕нр╕Ър╣Вр╕Фр╕вр╕Бр╕▓р╕гр╕кр╣Ир╕З GET Request р╣Др╕Ыр╕Чр╕╡р╣И
```
http://localhost:3000/api/v1/auth/me
```

р╣Бр╕ер╣Йр╕зр╣Бр╕Щр╕Ъ Token р╕Чр╕╡р╣Ир╣Др╕Фр╣Йр╕Ир╕▓р╕Бр╕Бр╕▓р╕г Login р╣Др╕Ыр╣Гр╕Щ Header
```
Authorization: Bearer <your_token_here>
```

![[20250403-1010-16.8296460.mp4]]
р╣Ар╕бр╕╖р╣Ир╕нр╕Чр╕│р╕кр╕│р╣Ар╕гр╣Зр╕И Backend р╕Ир╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ
``` json
{
  "userId":"00001",
  "name":"testuser",
  "email":"test@gmail.com",
  "role":"user"
}
```

р╣Ар╕Чр╣Ир╕▓р╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Бр╣Зр╕кр╕│р╣Ар╕гр╣Зр╕Ир╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╕гр╕░р╕Ър╕Ъ Authentication р╕Юр╕гр╣Йр╕нр╕б Middleware р╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕вр╣Бр╕ер╣Йр╕зр╕Юр╕гр╣Йр╕нр╕бр╕Чр╕╡р╣Ир╕Ир╕░р╣Др╕Ыр╕Чр╕│р╣Гр╕Щр╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╣Ар╕лр╕ер╕╖р╕нр╕Вр╕нр╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕Бр╕▒р╕Щр╕Хр╣Ир╕н

### **7.4 Implement CRUD operations р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Хр╕▓р╕гр╕▓р╕Зр╕нр╕╖р╣Ир╕Щр╣Ж**
р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Б Backend р╕Вр╕нр╕Зр╣Ар╕гр╕▓р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Хр╕▒р╕зр╕Хр╕Щр╕Вр╕нр╕З User р╣Др╕Фр╣Йр╣Бр╕ер╣Йр╕з
р╕Чр╕╡р╣Ир╣Ар╕лр╕ер╕╖р╕нр╕Бр╣Зр╣Бр╕Др╣Ир╕гр╕░р╕Ър╕Ър╕нр╕╖р╣Ир╕Щр╣Ж р╣Ар╕Кр╣Ир╕Щ р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕г Project, Task, Assignment, Attachment р╣Бр╕ер╕░р╕нр╕╖р╣Ир╕Щр╣Ж

р╣Вр╕Фр╕вр╕Чр╕╡р╣Ир╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕лр╕ер╣Ир╕▓р╕Щр╕╡р╣Йр╕Ир╕░р╕бр╕╡ Opearation р╕лр╕ер╕▒р╕Бр╣Жр╕Др╕╖р╕н
- р╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З (Create)
- р╕Бр╕▓р╕гр╕нр╣Ир╕▓р╕Щ (Read)
- р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В (Update)
- р╕Бр╕▓р╕гр╕ер╕Ъ (Delete)
р╣Ар╕гр╕╡р╕вр╕Бр╕гр╕зр╕бр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕бр╕▒р╕Бр╕Ир╕░р╣Ар╕гр╕╡р╕вр╕Бр╕зр╣Ир╕▓ CRUD Operation р╣Ар╕лр╕ер╣Ир╕▓р╕Щр╕╡р╣Йр╣Ар╕Ыр╣Зр╕Щ Operation р╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щр╕Чр╕╡р╣Ир╕Чр╕╕р╕Бр╕Хр╕▓р╕гр╕▓р╕Зр╕Др╕зр╕гр╕Ир╕░р╕бр╕╡ р╣Ар╕зр╣Йр╕Щр╣Бр╕Хр╣Ир╕бр╕╡р╕Ър╕▓р╕Зр╕Хр╕▓р╕гр╕▓р╕Зр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕бр╕╡р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕Ыр╣Зр╕Щр╕Юр╕┤р╣Ар╕ир╕йр╕Бр╣Зр╕нр╕▓р╕Ир╕Ир╕░р╣Др╕бр╣Ир╕бр╕╡р╕Бр╣Зр╣Др╕Фр╣Й

р╣Бр╕Хр╣Ир╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕гр╕▓ р╣Бр╕Хр╣Ир╕ер╕░р╕Хр╕▓р╕гр╕▓р╕Зр╕Ир╕░р╕бр╕╡ CRUD Operation р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Ар╕гр╕▓р╕Ир╕░р╕бр╕▓р╕Чр╕│ CRUD Operation р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Хр╕▓р╕гр╕▓р╕З Project р╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Бр╕▒р╕Щ

#### 7.4.1 р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М projectRouter.js р╣Бр╕ер╕░ projectController.js

р╣Гр╕Щ Folder routes р╣Гр╕лр╣Йр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М projectRouter.js р╕Вр╕╢р╣Йр╕Щр╕бр╕▓
![[Pasted image 20250403172307.png]]

```javascript
// routes/projectRouter.js
import express from "express";
import {
  createProject,
  getProjectFromID,
  getProject,
  updateProject,
  deleteProject,
} from "../controllers/projectController.js";
import { authMiddleware } from "../middleware/authMiddleware.js";

const router = express.Router();

router.post("/", authMiddleware, createProject);
router.get("/", authMiddleware, getProjectFromID);

// /:id р╣Ар╕гр╕╡р╕вр╕Бр╕зр╣Ир╕▓ reqest parameter р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕Кр╣Ир╕Щ http://localhost:3000/projects/1
// р╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╣Бр╕Ыр╕гр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕гр╕░р╕Ър╕╕ project_id р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕кр╣Ир╕бр╕▓р╣Гр╕Щ URL р╣Др╕Фр╣Йр╣Ар╕ер╕вр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕кр╣Ир╕Зр╣Гр╕Щ body
// р╕Лр╕╢р╣Ир╕З Method GET р╕Ыр╕Бр╕Хр╕┤р╕Ир╕░р╣Др╕бр╣Ир╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щ body р╣Бр╕Хр╣Ир╕Ир╕░р╕кр╣Ир╕Зр╣Гр╕Щ URL р╣Бр╕Чр╕Щ
// р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Ар╕гр╕▓р╕Ир╕╢р╕Зр╣Гр╕Кр╣Й request parameter р╣Гр╕Щр╕Бр╕▓р╕гр╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е project_id р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г
router.get("/:id", authMiddleware, getProject);
router.put("/:id", authMiddleware, updateProject);
router.delete("/:id", authMiddleware, deleteProject);

export default router;

```

р╣Гр╕Щ Folder controllers р╣Гр╕лр╣Йр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М projectController.js р╕Вр╕╢р╣Йр╕Щр╕бр╕▓
![[Pasted image 20250403172611.png]]

```javascript
// controllers/projectController.js
import { query } from "../config/database.js";

export async function createProject(req, res) {}

export async function getAllProjects(req, res) {}

export async function getProjectFromID(req, res) {}

export async function updateProject(req, res) {}

export async function deleteProject(req, res) {}
```

р╣Ар╕Фр╕╡р╣Лр╕вр╕зр╕Ир╕░р╕Юр╕▓р╕Чр╕│р╣Др╕Ыр╕Чр╕╡р╕ер╕░р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Щр╕░
р╣Ар╕гр╕┤р╣Ир╕бр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З Project р╕Бр╣Ир╕нр╕Щ

#### 7.4.2 Create Project

```javascript
export async function createProject(req, res) {
  try {
    // р╣Ар╕гр╕┤р╣Ир╕бр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕Ир╕▓р╕Б request body
    const { projectName, projectDescription, category } = req.body;

    // р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕Цр╕╣р╕Бр╕кр╣Ир╕Зр╕бр╕▓р╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    if (!projectName || !category) {
      return res.status(400).json({ error: "Missing required fields." });
    }

    // р╕кр╕гр╣Йр╕▓р╕З project_id р╣Гр╕лр╕бр╣И
    // р╣Вр╕Фр╕вр╣Гр╕Кр╣Йр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ generate_project_id() р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕зр╣Йр╣Гр╕Щ init.sql
    const idRes = await query("SELECT generate_project_id() as id");
    const projectId = idRes.rows[0].id; // р╕Фр╕╢р╕З project_id р╕Чр╕╡р╣Ир╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щр╕бр╕▓

    // р╕кр╕гр╣Йр╕▓р╕З Project р╣Гр╕лр╕бр╣Ир╣Гр╕Щ р╕Хр╕▓р╕гр╕▓р╕З project
    await query(
      `INSERT INTO project (project_id, project_name, project_description, owner_id, category)
         VALUES ($1, $2, $3, $4, $5)`,
      [projectId, projectName, projectDescription, req.user.userId, category] // р╕У р╕Хр╣Ир╕│р╣Бр╕лр╕Щр╣Ир╕З $n р╕Ир╕░р╕Цр╕╣р╕Бр╣Бр╕Чр╕Щр╕Чр╕╡р╣Ир╕Фр╣Йр╕зр╕вр╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕кр╣Ир╕Зр╣Др╕Ыр╕Хр╕▓р╕бр╕ер╕│р╕Фр╕▒р╕Ъ
    );

    res.status(201).json({ message: "Project created", projectId });
  } catch (error) {
    console.error("Create project error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}
```

#### 7.4.3 Get All Projects
```javascript
export async function getAllProjects(req, res) {
  try {
    // р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Чр╕╡р╣Ир╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Ар╕Ыр╣Зр╕Щр╕кр╕бр╕▓р╕Кр╕┤р╕Б
    const result = await query(
      `SELECT p.* FROM project p
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE p.owner_id = $1 OR pm.user_id = $1`,
      [req.user.userId]
    );
    res.status(200).json(result.rows);
  } catch (error) {
    console.error("getAllProjects error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}
```

##### 7.4.4 Get Project From ID
```javascript
export async function getProjectFromID(req, res) {
  try {
    // р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕Ир╕▓р╕Б project_id р╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╣Гр╕Щ request parameters
    // р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З URL: http://localhost:3000/projects/1
    const { id } = req.params;

    // р╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕Чр╕╡р╣Ир╕бр╕╡ project_id р╕Хр╕гр╕Зр╕Бр╕▒р╕Ър╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╣Гр╕Щ request parameters
    const result = await query(
      `SELECT p.* FROM project p
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE p.project_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [id, req.user.userId]
    );

    // р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕Юр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕Чр╕╡р╣Ир╕Хр╕гр╕Зр╕Бр╕▒р╕Ъ project_id р╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╣Гр╕Щ request parameters
    // р╕Ир╕░р╕кр╣Ир╕З status 404 Not Found р╕Бр╕ер╕▒р╕Ър╣Др╕Ы
    if (result.rowCount === 0)
      return res.status(404).json({ error: "Not found" });

    // р╕Цр╣Йр╕▓р╕Юр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕Чр╕╡р╣Ир╕Хр╕гр╕Зр╕Бр╕▒р╕Ъ project_id р╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╣Гр╕Щ request parameters
    res.status(200).json(result.rows[0]);
  } catch (error) {
    console.error("getProject error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}
```

#### 7.4.5 Update Project
```javascript
export async function updateProject(req, res) {
  try {
    const { id } = req.params; // р╕Фр╕╢р╕З project_id р╕Ир╕▓р╕Б request parameters
    const { projectName, projectDescription, category } = req.body; // р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕бр╕▓р╣Гр╕Щ request body

    // р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕Цр╕╣р╕Бр╕кр╣Ир╕Зр╕бр╕▓р╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    if (!projectName || !category) {
      return res.status(400).json({ error: "Missing required fields." });
    }

    // р╕Чр╕│р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Др╕Щр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕Др╕│р╕Вр╕нр╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕Щр╕╡р╣Йр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    const ownerCheck = await query(
      "SELECT owner_id FROM project WHERE project_id = $1",
      [id]
    );
    if (
      !ownerCheck.rows[0] ||
      ownerCheck.rows[0].owner_id !== req.user.userId
    ) {
      // р╕Цр╣Йр╕▓р╕Др╕Щр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕Др╕│р╕Вр╕нр╣Др╕бр╣Ир╣Гр╕Кр╣Ир╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д р╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╕Юр╕Ър╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╣Гр╕Щр╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е р╕Ир╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Фр╣Йр╕зр╕в status 403 р╣Бр╕ер╕░р╣Др╕бр╣Ир╣Гр╕лр╣Йр╕Чр╕│р╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х
      return res.status(403).json({ error: "Not authorized" });
    }

    // р╕Цр╣Йр╕▓р╕Ьр╣Ир╕▓р╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Бр╕ер╣Йр╕з р╕Чр╕│р╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д
    await query(
      `UPDATE project SET project_name=$1, project_description=$2, category=$3
       WHERE project_id=$4`,
      [projectName, projectDescription, category, id]
    );
    // р╕Цр╣Йр╕▓р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕кр╕│р╣Ар╕гр╣Зр╕И р╕Ир╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Фр╣Йр╕зр╕в status 200 р╣Бр╕ер╕░р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕зр╣Ир╕▓ "Project updated"
    res.status(200).json({ message: "Project updated" });
  } catch (error) {
    // р╕Цр╣Йр╕▓р╕бр╕╡р╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╣Ар╕Бр╕┤р╕Фр╕Вр╕╢р╣Йр╕Щ р╕Ир╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Фр╣Йр╕зр╕в status 500 р╣Бр╕ер╕░р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕зр╣Ир╕▓ "Internal server error"
    console.error("updateProject error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}
```

#### 7.4.6 Delete Project
```javascript
export async function deleteProject(req, res) {
  try {
    const { id } = req.params; // р╕Фр╕╢р╕З project_id р╕Ир╕▓р╕Б request parameters

    // р╕Чр╕│р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Др╕Щр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕Др╕│р╕Вр╕нр╕Ир╕░р╕ер╕Ър╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕Щр╕╡р╣Йр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    const ownerCheck = await query(
      "SELECT owner_id FROM project WHERE project_id = $1",
      [id]
    );
    if (
      !ownerCheck.rows[0] ||
      ownerCheck.rows[0].owner_id !== req.user.userId
    ) {
      // р╕Цр╣Йр╕▓р╕Др╕Щр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕Др╕│р╕Вр╕нр╣Др╕бр╣Ир╣Гр╕Кр╣Ир╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д р╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╕Юр╕Ър╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╣Гр╕Щр╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е р╕Ир╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Фр╣Йр╕зр╕в status 403 р╣Бр╕ер╕░р╣Др╕бр╣Ир╣Гр╕лр╣Йр╕Чр╕│р╕Бр╕▓р╕гр╕ер╕Ъ
      return res.status(403).json({ error: "Not authorized" });
    }

    // р╕Цр╣Йр╕▓р╕Ьр╣Ир╕▓р╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Бр╕ер╣Йр╕з р╕Чр╕│р╕Бр╕▓р╕гр╕ер╕Ър╣Вр╕Ыр╕гр╣Ар╕Ир╕Д
    await query("DELETE FROM project WHERE project_id = $1", [id]);

    // р╕Цр╣Йр╕▓р╕ер╕Ър╕кр╕│р╣Ар╕гр╣Зр╕И р╕Ир╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Фр╣Йр╕зр╕в status 200 р╣Бр╕ер╕░р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕зр╣Ир╕▓ "Project deleted"
    res.status(200).json({ message: "Project deleted" });
  } catch (error) {
    // р╕Цр╣Йр╕▓р╕бр╕╡р╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╣Ар╕Бр╕┤р╕Фр╕Вр╕╢р╣Йр╕Щ р╕Ир╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Фр╣Йр╕зр╕в status 500 р╣Бр╕ер╕░р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕зр╣Ир╕▓ "Internal server error"
    console.error("deleteProject error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}
```

#### 7.4.7 р╕кр╕гр╣Йр╕▓р╕З Route р╣Гр╕лр╕бр╣Ир╣Гр╕Щ index.js
р╣Гр╕Щр╣Др╕Яр╕ер╣М index.js р╣Гр╕лр╣Й import projectRouter р╣Ар╕Вр╣Йр╕▓р╕бр╕▓
```javascript
import express from "express";
import dotenv from "dotenv";
import { testConnection } from "./test.js";
import authRouter from "./routes/authRouter.js";
import projectRouter from "./routes/projectRouter.js";

dotenv.config();
const app = express();
const PORT = process.env.PORT || 3000;

app.use(express.json());
app.use("/api/v1/auth", authRouter);
app.use("/api/v1/projects", projectRouter);

app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
  testConnection();
});
```

#### 7.4.8 р╕Чр╕Фр╕кр╕нр╕Ъ CRUD Project
р╕ер╕нр╕Зр╕Чр╕Фр╕кр╕нр╕Ъ CRUD Project р╣Вр╕Фр╕вр╣Гр╕Кр╣Й Postman
![[postman_test.mp4]]

1. **Create Project**
    - Method: POST
    - URL: http://localhost:3000/api/v1/projects
    - Body:
  ```json
  {
    "projectName": "Test Project",
    "projectDescription": "This is a test project",
    "category": "Development"
  }
  ```
    - Header:
  ```
  Authorization: Bearer <your_token_here>
  ```

  2. **Get All Projects**
    - Method: GET
    - URL: http://localhost:3000/api/v1/projects
    - Header:
  ```
  Authorization: Bearer <your_token_here>
  ```

  3. **Get Project From ID**
    - Method: GET
    - URL: http://localhost:3000/api/v1/projects/<project_id>
    - Header:
  ```
  Authorization: Bearer <your_token_here>
  ```

  4. **Update Project**
    - Method: PUT
    - URL: http://localhost:3000/api/v1/projects/<project_id>
    - Body:
  ```json
  {
    "projectName": "Updated Project",
    "projectDescription": "This is an updated project",
    "category": "Development"
  }
  ```
    - Header:
  ```
  Authorization: Bearer <your_token_here>
  ```

  5. **Delete Project**
    - Method: DELETE
    - URL: http://localhost:3000/api/v1/projects/<project_id>
    - Header:
  ```
  Authorization: Bearer <your_token_here>
  ```

#### 7.4.9 р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Хр╕▓р╕гр╕▓р╕Зр╕нр╕╖р╣Ир╕Щр╣Ж
р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Хр╕▓р╕гр╕▓р╕Зр╕нр╕╖р╣Ир╕Щр╣Жр╕Бр╣Зр╕Ир╕░р╕бр╕╡ CRUD Operation р╕Чр╕╡р╣Ир╕Др╕ер╣Йр╕▓р╕вр╕Бр╕▒р╕Щ
- taskRouter.js
``` javascript
// routes/taskRouter.js
import express from "express";
import {
  createTask,
  getAllTasks,
  getTask,
  updateTask,
  deleteTask,
  assignUser,
  unassignUser,
  getTaskAssignees,
  getUserTasks,
} from "../controllers/taskController.js";
import { authMiddleware } from "../middleware/authMiddleware.js";

const router = express.Router();

router.use(authMiddleware);

router.get("/", getAllTasks);
router.get("/me", getUserTasks);
router.get("/:id", getTask);
router.post("/", createTask);
router.put("/:id", updateTask);
router.delete("/:id", deleteTask);

// Task assignee routes
router.get("/:taskId/assignees", getTaskAssignees);
router.post("/:taskId/assignees", assignUser);
router.delete("/:taskId/assignees/:userId", unassignUser);

export default router;

```

- taskController.js
```javascript
// controllers/taskController.js
import { query } from "../config/database.js";

export async function createTask(req, res) {
  console.info(
    "createTask: Request received, body=" + JSON.stringify(req.body)
  );
  try {
    const {
      projectId,
      taskName,
      taskDescription,
      startDate,
      dueDate,
      status,
      priority,
      assignees,
    } = req.body;
    if (!projectId || !taskName) {
      return res.status(400).json({ error: "Missing required fields." });
    }
    const sanitizedProjectId = projectId.trim();
    const sanitizedTaskName = taskName.trim();
    const sanitizedTaskDescription = taskDescription
      ? taskDescription.trim()
      : "";
    const sanitizedStatus = status ? status.trim() : "pending";
    const membershipCheck = await query(
      `SELECT p.project_id
       FROM project p
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE p.project_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [sanitizedProjectId, req.user.userId]
    );
    if (membershipCheck.rowCount === 0)
      return res.status(403).json({ error: "Not authorized" });

    const newId = await query("SELECT generate_task_id() as id");
    const taskId = newId.rows[0].id;
    await query(
      `INSERT INTO task (task_id, project_id, task_name, task_description, start_date, due_date, status, priority)
       VALUES ($1, $2, $3, $4, $5, $6, $7, $8)`,
      [
        taskId,
        sanitizedProjectId,
        sanitizedTaskName,
        sanitizedTaskDescription,
        startDate,
        dueDate,
        sanitizedStatus,
        priority,
      ]
    );

    // Add assignees if provided
    if (assignees && Array.isArray(assignees) && assignees.length > 0) {
      // Validate that all assignees are members of the project
      for (const assigneeId of assignees) {
        const isMember = await query(
          `SELECT user_id FROM project_member
           WHERE project_id = $1 AND user_id = $2
           UNION
           SELECT owner_id FROM project
           WHERE project_id = $1 AND owner_id = $2`,
          [sanitizedProjectId, assigneeId]
        );

        if (isMember.rowCount > 0) {
          await query(
            "INSERT INTO task_assignee (task_id, user_id) VALUES ($1, $2)",
            [taskId, assigneeId]
          );
          console.debug(
            `createTask: User ${assigneeId} assigned to task ${taskId}`
          );
        } else {
          console.warn(
            `createTask: Attempted to assign non-member ${assigneeId} to task ${taskId}`
          );
        }
      }
    }

    console.info(
      `createTask: Task ${taskId} created in project ${sanitizedProjectId}`
    );
    res.status(201).json({ message: "Task created", taskId });
  } catch (error) {
    console.error("createTask error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

export async function getAllTasks(req, res) {
  console.info(
    "getAllTasks: Request received, query=" + JSON.stringify(req.query)
  );
  try {
    const { projectId } = req.query;
    const membershipCheck = await query(
      `SELECT p.project_id
       FROM project p
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE p.project_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [projectId, req.user.userId]
    );
    if (membershipCheck.rowCount === 0)
      return res.status(403).json({ error: "Not authorized" });

    // Get tasks with their assignees
    const result = await query(
      `SELECT t.*,
        (SELECT json_agg(json_build_object('user_id', ta.user_id))
         FROM task_assignee ta
         WHERE ta.task_id = t.task_id) as assignees
       FROM task t WHERE t.project_id = $1`,
      [projectId]
    );
    console.info(
      `getAllTasks: Retrieved ${result.rowCount} tasks for project ${projectId}`
    );
    res.status(200).json(result.rows);
  } catch (error) {
    console.error("getAllTasks error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

export async function getTask(req, res) {
  console.info(
    "getTask: Request received, params=" + JSON.stringify(req.params)
  );
  try {
    const { id } = req.params;

    // Get task with assignee details
    const result = await query(
      `SELECT t.*,
        (SELECT json_agg(json_build_object('user_id', ta.user_id))
         FROM task_assignee ta
         WHERE ta.task_id = t.task_id) as assignees
       FROM task t
       JOIN project p ON t.project_id = p.project_id
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [id, req.user.userId]
    );
    if (result.rowCount === 0)
      return res.status(404).json({ error: "Not found or not authorized" });
    console.info(`getTask: Retrieved task ${id}`);
    res.status(200).json(result.rows[0]);
  } catch (error) {
    console.error("getTask error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

export async function updateTask(req, res) {
  console.info(
    "updateTask: Request received, params=" +
      JSON.stringify(req.params) +
      ", body=" +
      JSON.stringify(req.body)
  );
  try {
    const { id } = req.params;
    const {
      taskName,
      taskDescription,
      startDate,
      dueDate,
      status,
      priority,
      assignees,
    } = req.body;
    if (!taskName) {
      return res.status(400).json({ error: "Missing required fields." });
    }
    const sanitizedTaskName = taskName.trim();
    const sanitizedTaskDescription = taskDescription
      ? taskDescription.trim()
      : "";
    const sanitizedStatus = status ? status.trim() : "pending";

    // Get task and project info to verify membership and project ID
    const membershipCheck = await query(
      `SELECT t.*, p.project_id
       FROM task t
       JOIN project p ON t.project_id = p.project_id
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [id, req.user.userId]
    );
    if (membershipCheck.rowCount === 0)
      return res.status(403).json({ error: "Not authorized" });

    const projectId = membershipCheck.rows[0].project_id;

    // Update task details
    await query(
      `UPDATE task SET task_name=$1, task_description=$2, start_date=$3, due_date=$4, status=$5, priority=$6
       WHERE task_id=$7`,
      [
        sanitizedTaskName,
        sanitizedTaskDescription,
        startDate,
        dueDate,
        sanitizedStatus,
        priority,
        id,
      ]
    );

    // Update assignees if provided
    if (assignees && Array.isArray(assignees)) {
      // Clear existing assignments
      await query("DELETE FROM task_assignee WHERE task_id = $1", [id]);

      // Add new assignments
      if (assignees.length > 0) {
        for (const assigneeId of assignees) {
          const isMember = await query(
            `SELECT user_id FROM project_member
             WHERE project_id = $1 AND user_id = $2
             UNION
             SELECT owner_id FROM project
             WHERE project_id = $1 AND owner_id = $2`,
            [projectId, assigneeId]
          );

          if (isMember.rowCount > 0) {
            await query(
              "INSERT INTO task_assignee (task_id, user_id) VALUES ($1, $2)",
              [id, assigneeId]
            );
            console.debug(
              `updateTask: User ${assigneeId} assigned to task ${id}`
            );
          } else {
            console.warn(
              `updateTask: Attempted to assign non-member ${assigneeId} to task ${id}`
            );
          }
        }
      }
    }

    console.info(`updateTask: Task ${id} updated`);
    res.status(200).json({ message: "Task updated" });
  } catch (error) {
    console.error("updateTask error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

export async function deleteTask(req, res) {
  console.info(
    "deleteTask: Request received, params=" + JSON.stringify(req.params)
  );
  try {
    const { id } = req.params;
    const membershipCheck = await query(
      `SELECT t.*
       FROM task t
       JOIN project p ON t.project_id = p.project_id
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [id, req.user.userId]
    );
    if (membershipCheck.rowCount === 0)
      return res.status(403).json({ error: "Not authorized" });

    // Note: Deletion from task_assignee table will be handled by CASCADE constraint
    await query("DELETE FROM task WHERE task_id = $1", [id]);
    console.info(`deleteTask: Task ${id} deleted`);
    res.status(200).json({ message: "Task deleted" });
  } catch (error) {
    console.error("deleteTask error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

// New functions for managing task assignees
export async function assignUser(req, res) {
  console.info(
    "assignUser: Request received, params=" +
      JSON.stringify(req.params) +
      ", body=" +
      JSON.stringify(req.body)
  );
  try {
    const { taskId } = req.params;
    const { userId } = req.body;

    if (!userId) {
      return res.status(400).json({ error: "Missing required field: userId." });
    }

    // Check if user has permission to modify the task (is member of the project)
    const taskCheck = await query(
      `SELECT t.task_id, p.project_id
       FROM task t
       JOIN project p ON t.project_id = p.project_id
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [taskId, req.user.userId]
    );

    if (taskCheck.rowCount === 0) {
      return res
        .status(403)
        .json({ error: "Not authorized to modify this task" });
    }

    const projectId = taskCheck.rows[0].project_id;

    // Check if the assignee is a member of the project
    const memberCheck = await query(
      `SELECT user_id FROM project_member
       WHERE project_id = $1 AND user_id = $2
       UNION
       SELECT owner_id FROM project
       WHERE project_id = $1 AND owner_id = $2`,
      [projectId, userId]
    );

    if (memberCheck.rowCount === 0) {
      return res
        .status(400)
        .json({ error: "User is not a member of the project" });
    }

    // Check if the assignment already exists
    const assignmentCheck = await query(
      "SELECT * FROM task_assignee WHERE task_id = $1 AND user_id = $2",
      [taskId, userId]
    );

    if (assignmentCheck.rowCount > 0) {
      return res
        .status(400)
        .json({ error: "User is already assigned to this task" });
    }

    // Add assignment
    await query(
      "INSERT INTO task_assignee (task_id, user_id) VALUES ($1, $2)",
      [taskId, userId]
    );

    console.info(`assignUser: User ${userId} assigned to task ${taskId}`);
    res.status(201).json({ message: "User assigned to task" });
  } catch (error) {
    console.error("assignUser error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

export async function unassignUser(req, res) {
  console.info(
    "unassignUser: Request received, params=" + JSON.stringify(req.params)
  );
  try {
    const { taskId, userId } = req.params;

    // Check if user has permission to modify the task
    const taskCheck = await query(
      `SELECT t.task_id
       FROM task t
       JOIN project p ON t.project_id = p.project_id
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [taskId, req.user.userId]
    );

    if (taskCheck.rowCount === 0) {
      return res
        .status(403)
        .json({ error: "Not authorized to modify this task" });
    }

    // Remove assignment
    await query(
      "DELETE FROM task_assignee WHERE task_id = $1 AND user_id = $2",
      [taskId, userId]
    );

    console.info(`unassignUser: User ${userId} unassigned from task ${taskId}`);
    res.status(200).json({ message: "User unassigned from task" });
  } catch (error) {
    console.error("unassignUser error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

export async function getTaskAssignees(req, res) {
  console.info(
    "getTaskAssignees: Request received, params=" + JSON.stringify(req.params)
  );
  try {
    const { taskId } = req.params;

    // Check if user has permission to view the task
    const taskCheck = await query(
      `SELECT t.task_id
       FROM task t
       JOIN project p ON t.project_id = p.project_id
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [taskId, req.user.userId]
    );

    if (taskCheck.rowCount === 0) {
      return res
        .status(403)
        .json({ error: "Not authorized to view this task" });
    }

    // Get assignees with user details
    const assignees = await query(
      `SELECT ta.user_id, u.username, u.email
       FROM task_assignee ta
       JOIN users u ON ta.user_id = u.user_id
       WHERE ta.task_id = $1`,
      [taskId]
    );

    console.info(
      `getTaskAssignees: Retrieved ${assignees.rowCount} assignees for task ${taskId}`
    );
    res.status(200).json(assignees.rows);
  } catch (error) {
    console.error("getTaskAssignees error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

export async function getUserTasks(req, res) {
  console.info("getUserTasks: Request received");
  try {
    const userId = req.user.userId;

    // Get tasks with more details and assignee information
    const tasks = await query(
      `SELECT t.*, p.project_name,
        (SELECT json_agg(json_build_object('user_id', u.user_id, 'username', u.username, 'email', u.email))
         FROM task_assignee ta
         JOIN users u ON ta.user_id = u.user_id
         WHERE ta.task_id = t.task_id) as assignees
       FROM task t
       JOIN task_assignee ta ON t.task_id = ta.task_id
       JOIN project p ON t.project_id = p.project_id
       WHERE ta.user_id = $1
       ORDER BY t.due_date ASC NULLS LAST, t.priority DESC`,
      [userId]
    );

    console.info(
      `getUserTasks: Retrieved ${tasks.rowCount} tasks for user ${userId}`
    );
    res.status(200).json(tasks.rows);
  } catch (error) {
    console.error("getUserTasks error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}
```

projectMemberRouter.js
```javascript
// routes/projectMemberRouter.js
import express from "express";
import {
  addProjectMember,
  removeProjectMember,
} from "../controllers/projectMemberController.js";
import { authMiddleware } from "../middleware/authMiddleware.js";

const router = express.Router();

router.use(authMiddleware);

router.post("/:projectId/members", addProjectMember);
router.delete("/:projectId/members/:userId", removeProjectMember);

export default router;
```

projectMemberController.js
```javascript
// controllers/projectMemberController.js
import { query } from "../config/database.js";

export async function addProjectMember(req, res) {
  console.info(
    "addProjectMember: Request received, params=" +
      JSON.stringify(req.params) +
      ", body=" +
      JSON.stringify(req.body)
  );
  try {
    const { projectId } = req.params;
    let { userId } = req.body;
    if (!userId) {
      return res.status(400).json({ error: "Missing required field: userId." });
    }
    userId = userId.trim();
    // Verify requester is the owner
    const ownerRes = await query(
      "SELECT owner_id FROM project WHERE project_id = $1",
      [projectId]
    );
    console.debug(
      "addProjectMember: Owner response: " + JSON.stringify(ownerRes)
    );
    if (!ownerRes.rows[0] || ownerRes.rows[0].owner_id !== req.user.userId) {
      return res.status(403).json({ error: "Not authorized" });
    }
    // Add user to project_member
    await query(
      "INSERT INTO project_member (project_id, user_id) VALUES ($1, $2)",
      [projectId, userId]
    );
    console.debug(
      `addProjectMember: Project member insertion complete for project ${projectId}`
    );
    console.info(
      `addProjectMember: Member ${userId} added to project ${projectId}`
    );
    res.status(201).json({ message: "User added to project" });
  } catch (error) {
    console.error("addProjectMember error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

export async function removeProjectMember(req, res) {
  console.info(
    "removeProjectMember: Request received, params=" +
      JSON.stringify(req.params)
  );
  try {
    const { projectId, userId } = req.params;
    // Verify requester is the owner
    const ownerRes = await query(
      "SELECT owner_id FROM project WHERE project_id = $1",
      [projectId]
    );
    console.debug(
      "removeProjectMember: Owner response: " + JSON.stringify(ownerRes)
    );
    if (!ownerRes.rows[0] || ownerRes.rows[0].owner_id !== req.user.userId) {
      return res.status(403).json({ error: "Not authorized" });
    }
    // Remove user from project_member
    await query(
      "DELETE FROM project_member WHERE project_id = $1 AND user_id = $2",
      [projectId, userId]
    );
    console.debug(
      `removeProjectMember: Deletion query complete for user ${userId} and project ${projectId}`
    );
    console.info(
      `removeProjectMember: Member ${userId} removed from project ${projectId}`
    );
    res.status(200).json({ message: "User removed from project" });
  } catch (error) {
    console.error("removeProjectMember error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}
```

- attachmentsRouter.js
```javascript
// routes/attachmentsRouter.js
import express from "express";
import {
  createAttachment,
  getAttachment,
  getAllAttachments,
  updateAttachment,
  deleteAttachment,
} from "../controllers/attachmentController.js";
import { authMiddleware } from "../middleware/authMiddleware.js";

const router = express.Router();

router.use(authMiddleware);

router.post("/", createAttachment);
router.get("/", getAllAttachments);
router.get("/:id", getAttachment);
router.put("/:id", updateAttachment);
router.delete("/:id", deleteAttachment);

export default router;
```

- attachmentController.js
```javascript
// controllers/attachmentController.js
import { query } from "../config/database.js";

// Create attachment - checking user membership via task
export async function createAttachment(req, res) {
  console.info(
    "createAttachment: Request received, body=" + JSON.stringify(req.body)
  );
  try {
    // New input validation and sanitization
    const { attachmentName, taskId, file_url, file_type } = req.body;
    if (!attachmentName || !taskId || !file_url || !file_type) {
      return res.status(400).json({ error: "Missing required fields." });
    }
    const sanitizedAttachmentName = attachmentName.trim();
    const sanitizedTaskId = taskId.trim();
    const sanitizedFile_url = file_url.trim();
    const sanitizedFile_type = file_type.trim();
    // Verify user membership in the task's project
    const membershipCheck = await query(
      `SELECT t.task_id
       FROM task t
       JOIN project p ON t.project_id = p.project_id
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [sanitizedTaskId, req.user.userId]
    );
    if (membershipCheck.rowCount === 0) {
      return res
        .status(403)
        .json({ error: "Not authorized to add attachment to this task" });
    }
    const newIdRes = await query("SELECT generate_attachment_id() as id");
    const attachmentId = newIdRes.rows[0].id;
    await query(
      `INSERT INTO attachment (attachment_id, attachment_name, task_id, file_url, file_type)
       VALUES ($1, $2, $3, $4, $5)`,
      [
        attachmentId,
        sanitizedAttachmentName,
        sanitizedTaskId,
        sanitizedFile_url,
        sanitizedFile_type,
      ]
    );
    console.info(
      `createAttachment: Attachment ${attachmentId} created on task ${sanitizedTaskId}`
    );
    res.status(201).json({ message: "Attachment created", attachmentId });
  } catch (error) {
    console.error("createAttachment error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

// Get a single attachment with membership check
export async function getAttachment(req, res) {
  console.info(
    "getAttachment: Request received, params=" + JSON.stringify(req.params)
  );
  try {
    const { id } = req.params;
    const attachmentRes = await query(
      "SELECT * FROM attachment WHERE attachment_id = $1",
      [id]
    );
    if (attachmentRes.rowCount === 0)
      return res.status(404).json({ error: "Attachment not found" });
    const attachment = attachmentRes.rows[0];
    // Verify user membership via the task on which the attachment is attached
    const membershipCheck = await query(
      `SELECT t.task_id
       FROM task t
       JOIN project p ON t.project_id = p.project_id
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [attachment.task_id, req.user.userId]
    );
    if (membershipCheck.rowCount === 0) {
      return res
        .status(403)
        .json({ error: "Not authorized to view this attachment" });
    }
    console.info(`getAttachment: Attachment ${id} retrieved`);
    res.status(200).json(attachment);
  } catch (error) {
    console.error("getAttachment error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

// Get all attachments; if taskId provided, check membership, else retrieve attachments for allowed tasks
export async function getAllAttachments(req, res) {
  console.info(
    "getAllAttachments: Request received, query=" + JSON.stringify(req.query)
  );
  try {
    const { taskId } = req.query;
    if (taskId) {
      const membershipCheck = await query(
        `SELECT t.task_id
         FROM task t
         JOIN project p ON t.project_id = p.project_id
         LEFT JOIN project_member pm ON p.project_id = pm.project_id
         WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
        [taskId, req.user.userId]
      );
      if (membershipCheck.rowCount === 0) {
        return res
          .status(403)
          .json({ error: "Not authorized to view attachments for this task" });
      }
      const result = await query(
        "SELECT * FROM attachment WHERE task_id = $1",
        [taskId]
      );
      console.info(
        `getAllAttachments: Attachments for task ${taskId} retrieved`
      );
      return res.status(200).json(result.rows);
    } else {
      const result = await query(
        `SELECT a.*
         FROM attachment a
         JOIN task t ON a.task_id = t.task_id
         JOIN project p ON t.project_id = p.project_id
         LEFT JOIN project_member pm ON p.project_id = pm.project_id
         WHERE p.owner_id = $1 OR pm.user_id = $1`,
        [req.user.userId]
      );
      console.info(
        "getAllAttachments: Attachments for allowed tasks retrieved"
      );
      return res.status(200).json(result.rows);
    }
  } catch (error) {
    console.error("getAllAttachments error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

// Update attachment with membership check
export async function updateAttachment(req, res) {
  console.info(
    "updateAttachment: Request received, params=" +
      JSON.stringify(req.params) +
      ", body=" +
      JSON.stringify(req.body)
  );
  try {
    const { id } = req.params;
    // New input validation and sanitization
    const { attachmentName, file_url, file_type } = req.body;
    if (!attachmentName || !file_url || !file_type) {
      return res.status(400).json({ error: "Missing required fields." });
    }
    const sanitizedAttachmentName = attachmentName.trim();
    const sanitizedFile_url = file_url.trim();
    const sanitizedFile_type = file_type.trim();
    const attachmentRes = await query(
      "SELECT * FROM attachment WHERE attachment_id = $1",
      [id]
    );
    if (attachmentRes.rowCount === 0)
      return res.status(404).json({ error: "Attachment not found" });
    const attachment = attachmentRes.rows[0];
    const membershipCheck = await query(
      `SELECT t.task_id
       FROM task t
       JOIN project p ON t.project_id = p.project_id
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [attachment.task_id, req.user.userId]
    );
    if (membershipCheck.rowCount === 0) {
      return res
        .status(403)
        .json({ error: "Not authorized to update this attachment" });
    }
    await query(
      `UPDATE attachment SET attachment_name = $1, file_url = $2, file_type = $3
       WHERE attachment_id = $4`,
      [sanitizedAttachmentName, sanitizedFile_url, sanitizedFile_type, id]
    );
    console.info(`updateAttachment: Attachment ${id} updated`);
    res.status(200).json({ message: "Attachment updated" });
  } catch (error) {
    console.error("updateAttachment error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}

// Delete attachment with membership check
export async function deleteAttachment(req, res) {
  console.info(
    "deleteAttachment: Request received, params=" + JSON.stringify(req.params)
  );
  try {
    const { id } = req.params;
    const attachmentRes = await query(
      "SELECT * FROM attachment WHERE attachment_id = $1",
      [id]
    );
    if (attachmentRes.rowCount === 0)
      return res.status(404).json({ error: "Attachment not found" });
    const attachment = attachmentRes.rows[0];
    const membershipCheck = await query(
      `SELECT t.task_id
       FROM task t
       JOIN project p ON t.project_id = p.project_id
       LEFT JOIN project_member pm ON p.project_id = pm.project_id
       WHERE t.task_id = $1 AND (p.owner_id = $2 OR pm.user_id = $2)`,
      [attachment.task_id, req.user.userId]
    );
    if (membershipCheck.rowCount === 0) {
      return res
        .status(403)
        .json({ error: "Not authorized to delete this attachment" });
    }
    await query("DELETE FROM attachment WHERE attachment_id = $1", [id]);
    console.info(`deleteAttachment: Attachment ${id} deleted`);
    res.status(200).json({ message: "Attachment deleted" });
  } catch (error) {
    console.error("deleteAttachment error: " + error);
    res.status(500).json({ error: "Internal server error" });
  }
}
```
р╣Бр╕ер╣Йр╕зр╕нр╕вр╣Ир╕▓р╕ер╕╖р╕б import router р╣Ар╕Вр╣Йр╕▓р╕бр╕▓р╣Гр╕Щ index.js
```javascript
import express from "express";





